<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="UTF-8">

  <title>Squirrel Prover - Squirrel Prover</title>
  
  <link rel="stylesheet" href="style.css">
</head>

<body onkeydown="key(event)">
<span style="display: none;"><span class="squirrel-step" id="step0">
<span class="input-line" id="in0">(* signed dh key exchange *)<br>channel c.</span>
<span class="output-line" id="out0"></span>
</span>

<span class="squirrel-step" id="step1">
<span class="input-line" id="in1"><br><br>abstract ok : message<br><br>(*------------------------------------------------------------------*)<br>(* gdh group *)<br>type G<br>type E [large]<br><br>gdh gen, (^), ( ** ) where group:G exponents:E.</span>
<span class="output-line" id="out1"></span>
</span>

<span class="squirrel-step" id="step2">
<span class="input-line" id="in2"><br><br>(*------------------------------------------------------------------*)<br>(* This assumes INT-CTXT + IND-CPA, and adds the rewrite rule:<br>   dec(enc(x,r,k),k) = x *)<br>senc enc, dec.</span>
<span class="output-line" id="out2"></span>
</span>

<span class="squirrel-step" id="step3">
<span class="input-line" id="in3"><br><br>(*------------------------------------------------------------------*)<br>abstract E_e : E.</span>
<span class="output-line" id="out3"></span>
</span>

<span class="squirrel-step" id="step4">
<span class="input-line" id="in4"><br>abstract inv_E : E -&gt; E<br>abstract dlog : G -&gt; E<br>abstract ofG : G -&gt; message.</span>
<span class="output-line" id="out4"></span>
</span>

<span class="squirrel-step" id="step5">
<span class="input-line" id="in5"><br>abstract toG : message -&gt; G.</span>
<span class="output-line" id="out5"></span>
</span>

<span class="squirrel-step" id="step6">
<span class="input-line" id="in6"><br><br>(* conversion of agent names into messages *)<br>abstract agent : index -&gt; message.</span>
<span class="output-line" id="out6"></span>
</span>

<span class="squirrel-step" id="step7">
<span class="input-line" id="in7"><br><br>axiom [any] agent_inj (A, B:index) :<br>  (agent(A) = agent(B)) = (A = B).</span>
<span class="output-line" id="out7"><span class='goal' style='color: #AA0000'>axiom</span> [any] agent_inj :<br>  forall (A,B:index), (<span class='gf'>agent</span> A = <span class='gf'>agent</span> B) = (A = B)<br></span>
</span>

<span class="squirrel-step" id="step8">
<span class="input-line" id="in8"><br>hint rewrite agent_inj.</span>
<span class="output-line" id="out8"></span>
</span>

<span class="squirrel-step" id="step9">
<span class="input-line" id="in9"><br><br>abstract tag1:message.</span>
<span class="output-line" id="out9"></span>
</span>

<span class="squirrel-step" id="step10">
<span class="input-line" id="in10"><br>abstract tag2:message.</span>
<span class="output-line" id="out10"></span>
</span>

<span class="squirrel-step" id="step11">
<span class="input-line" id="in11"><br>axiom [any] tag_neq: (tag1 = tag2) = false.</span>
<span class="output-line" id="out11"><span class='goal' style='color: #AA0000'>axiom</span> [any] tag_neq :<br>  (<span class='gf'>tag1</span> = <span class='gf'>tag2</span>) = <span class='gf'>false</span><br></span>
</span>

<span class="squirrel-step" id="step12">
<span class="input-line" id="in12"><br><br>(* signature *)<br>signature sign,checksign,pk.</span>
<span class="output-line" id="out12"></span>
</span>

<span class="squirrel-step" id="step13">
<span class="input-line" id="in13"><br><br>axiom [any] sign_ax (x,y,k : message) : x = y =&gt; checksign(x, sign(y,k), pk(k)).</span>
<span class="output-line" id="out13"><span class='goal' style='color: #AA0000'>axiom</span> [any] sign_ax :<br>  forall (x,y,k:message), x = y =&gt; <span class='gf'>checksign</span> (x, <span class='gf'>sign</span> (y, k), <span class='gf'>pk</span> k)<br></span>
</span>

<span class="squirrel-step" id="step14">
<span class="input-line" id="in14"><br><br>abstract error : G.</span>
<span class="output-line" id="out14"></span>
</span>

<span class="squirrel-step" id="step15">
<span class="input-line" id="in15"><br><br>(* kdf *)<br>hash KDF.</span>
<span class="output-line" id="out15"></span>
</span>

<span class="squirrel-step" id="step16">
<span class="input-line" id="in16"><br><br>name kKDF : message.</span>
<span class="output-line" id="out16"></span>
</span>

<span class="squirrel-step" id="step17">
<span class="input-line" id="in17"><br><br>(* long term signing keys *)<br>name k : index -&gt; message.</span>
<span class="output-line" id="out17"></span>
</span>

<span class="squirrel-step" id="step18">
<span class="input-line" id="in18"><br><br>(* ephemerals for Alice  *)<br>name x : index * index * index -&gt; E.</span>
<span class="output-line" id="out18"></span>
</span>

<span class="squirrel-step" id="step19">
<span class="input-line" id="in19"><br><br>(* ephemerals for Bob  *)<br>name y : index * index * index -&gt; E.</span>
<span class="output-line" id="out19"></span>
</span>

<span class="squirrel-step" id="step20">
<span class="input-line" id="in20"><br><br>(* key derived by Alice(A, B, i) and Bob(A,B,j) *)<br>name dk : index * index * index * index -&gt; message.</span>
<span class="output-line" id="out20"></span>
</span>

<span class="squirrel-step" id="step21">
<span class="input-line" id="in21"><br><br>(* Alice(A,B): A sends g^x to B, receives g^y + signature, sends signature *)<br>process Alice (A:index, B:index, i:index) =<br>  let xA = x(A,B,i) in<br>  A1:out(c, ofG(gen^xA));<br>  in(c, mA);<br>  let gy = fst(mA) in<br>  let sA = snd(mA) in<br>  if checksign(&lt;tag1,&lt;agent(A),&lt;gy, ofG(gen^xA)&gt;&gt;&gt;, sA, pk(k(B))) then<br>    let gkA = toG(gy)^xA in<br>    let kA = KDF(ofG(gkA), kKDF) in<br>    A2:out(c, sign(&lt;tag2,&lt;agent(B), &lt;ofG(gen^xA), gy&gt;&gt;&gt;, k(A))).</span>
<span class="output-line" id="out21"></span>
</span>

<span class="squirrel-step" id="step22">
<span class="input-line" id="in22"><br><br>(* Bob(A,B): B receives g^x from A, sends g^y + signature, receives signature *)<br>process Bob (A:index, B:index, j:index) =<br>  in(c, gx);<br>  let yB = y(A,B,j) in<br>  B1:out(c, &lt;ofG(gen^yB), sign(&lt;tag1,&lt;agent(A), &lt;ofG(gen^yB), gx&gt;&gt;&gt;, k(B))&gt;);<br>  in(c, sB);<br>  if checksign(&lt;tag2,&lt;agent(B), &lt;gx, ofG(gen^yB)&gt;&gt;&gt;, sB, pk(k(A))) then<br>    let gkB = toG(gx)^yB in<br>    let kB = KDF(ofG(gkB), kKDF) in<br>    B2:out(c, ok).</span>
<span class="output-line" id="out22"></span>
</span>

<span class="squirrel-step" id="step23">
<span class="input-line" id="in23"> <br><br>process kdforacle (i:index) =<br>   in(c,x); O : <br>   out(c, KDF(x,kKDF)).</span>
<span class="output-line" id="out23"></span>
</span>

<span class="squirrel-step" id="step24">
<span class="input-line" id="in24"><br><br>process corrupt (A:index) =<br>  out(c, k(A)).</span>
<span class="output-line" id="out24"></span>
</span>

<span class="squirrel-step" id="step25">
<span class="input-line" id="in25"><br><br>process protocol = (<br>  (!_A (!_B (!_i (Alice(A,B,i) | Bob(A,B,i))))) | <br>  (!_A corrupt(A)) | <br>  (!_O kdforacle(O))<br>).</span>
<span class="output-line" id="out25"></span>
</span>

<span class="squirrel-step" id="step26">
<span class="input-line" id="in26"><br><br>system [default] protocol.</span>
<span class="output-line" id="out26">System before processing:<br>  <br>  <span class='pn'>protocol</span> <br><br>Added action dependencies lemmas:<br><br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] mutex_default_B3_B2 :<br>  forall (A,B,i:index), <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>B3(A, B, i)</span>) || <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>B2(A, B, i)</span>)<br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] mutex_default_B2_B3 :<br>  forall (A,B,i:index), <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>B2(A, B, i)</span>) || <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>B3(A, B, i)</span>)<br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] depends_default_B1_B3 :<br>  forall (t:timestamp,A,B,i:index),<br>    t = <span class='ga'>B3(A, B, i)</span> =&gt; <span class='gm'>happens</span>(t) =&gt; <span class='ga'>B1(A, B, i)</span> &lt; <span class='ga'>B3(A, B, i)</span><br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] depends_default_B1_B2 :<br>  forall (t:timestamp,A,B,i:index),<br>    t = <span class='ga'>B2(A, B, i)</span> =&gt; <span class='gm'>happens</span>(t) =&gt; <span class='ga'>B1(A, B, i)</span> &lt; <span class='ga'>B2(A, B, i)</span><br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] mutex_default_A3_A2 :<br>  forall (A,B,i:index), <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>A3(A, B, i)</span>) || <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] mutex_default_A2_A3 :<br>  forall (A,B,i:index), <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>) || <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>A3(A, B, i)</span>)<br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] depends_default_A1_A3 :<br>  forall (t:timestamp,A,B,i:index),<br>    t = <span class='ga'>A3(A, B, i)</span> =&gt; <span class='gm'>happens</span>(t) =&gt; <span class='ga'>A1(A, B, i)</span> &lt; <span class='ga'>A3(A, B, i)</span><br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] depends_default_A1_A2 :<br>  forall (t:timestamp,A,B,i:index),<br>    t = <span class='ga'>A2(A, B, i)</span> =&gt; <span class='gm'>happens</span>(t) =&gt; <span class='ga'>A1(A, B, i)</span> &lt; <span class='ga'>A2(A, B, i)</span><br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] depends_default_init_O :<br>  forall (t:timestamp,O:index), t = <span class='ga'>O(O)</span> =&gt; <span class='gm'>happens</span>(t) =&gt; <span class='ga'>init</span> &lt; <span class='ga'>O(O)</span><br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] depends_default_init_corrupt :<br>  forall (t:timestamp,A:index),<br>    t = <span class='ga'>corrupt(A)</span> =&gt; <span class='gm'>happens</span>(t) =&gt; <span class='ga'>init</span> &lt; <span class='ga'>corrupt(A)</span><br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] depends_default_init_B3 :<br>  forall (t:timestamp,A,B,i:index),<br>    t = <span class='ga'>B3(A, B, i)</span> =&gt; <span class='gm'>happens</span>(t) =&gt; <span class='ga'>init</span> &lt; <span class='ga'>B3(A, B, i)</span><br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] depends_default_init_B2 :<br>  forall (t:timestamp,A,B,i:index),<br>    t = <span class='ga'>B2(A, B, i)</span> =&gt; <span class='gm'>happens</span>(t) =&gt; <span class='ga'>init</span> &lt; <span class='ga'>B2(A, B, i)</span><br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] depends_default_init_B1 :<br>  forall (t:timestamp,A,B,i:index),<br>    t = <span class='ga'>B1(A, B, i)</span> =&gt; <span class='gm'>happens</span>(t) =&gt; <span class='ga'>init</span> &lt; <span class='ga'>B1(A, B, i)</span><br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] depends_default_init_A3 :<br>  forall (t:timestamp,A,B,i:index),<br>    t = <span class='ga'>A3(A, B, i)</span> =&gt; <span class='gm'>happens</span>(t) =&gt; <span class='ga'>init</span> &lt; <span class='ga'>A3(A, B, i)</span><br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] depends_default_init_A2 :<br>  forall (t:timestamp,A,B,i:index),<br>    t = <span class='ga'>A2(A, B, i)</span> =&gt; <span class='gm'>happens</span>(t) =&gt; <span class='ga'>init</span> &lt; <span class='ga'>A2(A, B, i)</span><br><span class='goal' style='color: #AA0000'>axiom</span> [left:default/left, right:default/right] depends_default_init_A1 :<br>  forall (t:timestamp,A,B,i:index),<br>    t = <span class='ga'>A1(A, B, i)</span> =&gt; <span class='gm'>happens</span>(t) =&gt; <span class='ga'>init</span> &lt; <span class='ga'>A1(A, B, i)</span><br><br>System after processing:<br>  <br>  (!_A<br>     !_B<br>       !_i<br>         (<span class='pk'>let</span> <span class='pv'>xA</span> = (x (A, B, i)) <span class='pk'>in</span><br>          A1:<br>          <span class='pio'>out</span>(<span>c</span>,(ofG (^ gen (xA A B i))));<br>          <span class='pio'>in</span>(<span>c</span>,<span class='pv'>mA</span>);<br>          <span class='pk'>let</span> <span class='pv'>gy</span> = (fst mA) <span class='pk'>in</span><br>          <span class='pk'>let</span> <span class='pv'>sA</span> = (snd mA) <span class='pk'>in</span><br>          <span class='pc'>if</span> (checksign ((pair tag1 (pair (agent A) (pair (gy A B i)<br>                        (ofG (^ gen (xA A B i)))))), (sA A B i), (pk (k B)))) <span class='pc'>then</span><br>            <span class='pk'>let</span> <span class='pv'>gkA</span> = (^ (toG (gy A B i)) (xA A B i)) <span class='pk'>in</span><br>            <span class='pk'>let</span> <span class='pv'>kA</span> = (KDF ((ofG (gkA A B i)), kKDF)) <span class='pk'>in</span><br>            A2:<br>            <span class='pio'>out</span>(<span>c</span>,<br>            (sign ((pair tag2 (pair (agent B) (pair (ofG (^ gen (xA A B i)))<br>                  (gy A B i)))), (k A)))); <span class='pn'>null</span> <span class='pc'>else</span> A3: <span class='pn'>null</span>) |<br>         (<span class='pio'>in</span>(<span>c</span>,<span class='pv'>gx</span>);<br>          <span class='pk'>let</span> <span class='pv'>yB</span> = (y (A, B, i)) <span class='pk'>in</span><br>          B1:<br>          <span class='pio'>out</span>(<span>c</span>,(pair (ofG (^ gen (yB A B i)))<br>          (sign ((pair tag1 (pair (agent A) (pair (ofG (^ gen (yB A B i)))<br>                gx))), (k B)))));<br>          <span class='pio'>in</span>(<span>c</span>,<span class='pv'>sB</span>);<br>          <span class='pc'>if</span> (checksign ((pair tag2 (pair (agent B) (pair gx (ofG (^ gen<br>                        (yB A B i)))))), sB, (pk (k A)))) <span class='pc'>then</span><br>            <span class='pk'>let</span> <span class='pv'>gkB</span> = (^ (toG gx) (yB A B i)) <span class='pk'>in</span><br>            <span class='pk'>let</span> <span class='pv'>kB</span> = (KDF ((ofG (gkB A B i)), kKDF)) <span class='pk'>in</span><br>            B2: <span class='pio'>out</span>(<span>c</span>,ok); <span class='pn'>null</span> <span class='pc'>else</span> B3: <span class='pn'>null</span>)) |<br>  ((!_A corrupt: <span class='pio'>out</span>(<span>c</span>,(k A)); <span class='pn'>null</span>) |<br>   (!_O <span class='pio'>in</span>(<span>c</span>,<span class='pv'>x</span>); O: <span class='pio'>out</span>(<span>c</span>,(KDF (x, kKDF))); <span class='pn'>null</span>))<br><br>System default registered with actions (init,A1,A2,A3,B1,B2,B3,corrupt,O).<br></span>
</span>

<span class="squirrel-step" id="step27">
<span class="input-line" id="in27"><br><br>(*------------------------------------------------------------------*)<br>include Basic.</span>
<span class="output-line" id="out27"><span class='goal' style='color: #AA0000'>axiom</span> [any] eq_iff :<br>  forall (x,y:bool), (x = y) = (x &lt;=&gt; y)<br><span class='goal' style='color: #AA0000'>axiom</span> [any] eq_not :<br>  forall (x,y:bool), (<span class='gf'>not</span> x = <span class='gf'>not</span> y) = (x = y)<br>Goal eq_sym :<br>  (x = y) = (y = x)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: x,y:&apos;a<br><span class='sep'>----------------------------------------</span><br>(x = y) = (y = x)<br><br>[&gt; Line 9: by (rewrite ...) [goal&gt; Goal eq_sym is proved <span class='goal' style='color: #AA0000'>goal</span> [any] eq_sym [&apos;a] :<br>  forall (x,y:&apos;a), (x = y) = (y = x)<br>Exiting proof mode.<br><br>Goal neq_sym :<br>  (x &lt;&gt; y) = (y &lt;&gt; x)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: x,y:&apos;a<br><span class='sep'>----------------------------------------</span><br>(x &lt;&gt; y) = (y &lt;&gt; x)<br><br>[&gt; Line 12: by (rewrite ...) [goal&gt; Goal neq_sym is proved <span class='goal' style='color: #AA0000'>goal</span> [any] neq_sym [&apos;a] :<br>  forall (x,y:&apos;a), (x &lt;&gt; y) = (y &lt;&gt; x)<br>Exiting proof mode.<br><br>Goal eq_refl_e :<br>  (x = x) = <span class='gf'>true</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: x:&apos;a<br><span class='sep'>----------------------------------------</span><br>(x = x) = <span class='gf'>true</span><br><br>[&gt; Line 16: by (rewrite ...) [goal&gt; Goal eq_refl_e is proved <span class='goal' style='color: #AA0000'>goal</span> [any] eq_refl_e [&apos;a] :<br>  forall (x:&apos;a), (x = x) = <span class='gf'>true</span><br>Exiting proof mode.<br><br>Goal eq_refl :<br>  x = x<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: x:&apos;a<br><span class='sep'>----------------------------------------</span><br>x = x<br><br>[&gt; Line 22: by (rewrite ...) [goal&gt; Goal eq_refl is proved <span class='goal' style='color: #AA0000'>goal</span> [any] eq_refl [&apos;a] :<br>  forall (x:&apos;a), x = x<br>Exiting proof mode.<br><br>Goal neq_irefl :<br>  x &lt;&gt; x &lt;=&gt; <span class='gf'>false</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: x:&apos;a<br><span class='sep'>----------------------------------------</span><br>x &lt;&gt; x &lt;=&gt; <span class='gf'>false</span><br><br>[&gt; Line 26: by split [goal&gt; Goal neq_irefl is proved <span class='goal' style='color: #AA0000'>goal</span> [any] neq_irefl [&apos;a] :<br>  forall (x:&apos;a), x &lt;&gt; x &lt;=&gt; <span class='gf'>false</span><br>Exiting proof mode.<br><br><span class='goal' style='color: #AA0000'>axiom</span> [any] true_false :<br>  (<span class='gf'>true</span> = <span class='gf'>false</span>) = <span class='gf'>false</span><br>Goal false_true :<br>  (<span class='gf'>false</span> = <span class='gf'>true</span>) = <span class='gf'>false</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br><span class='sep'>----------------------------------------</span><br>(<span class='gf'>false</span> = <span class='gf'>true</span>) = <span class='gf'>false</span><br><br>[&gt; Line 37: by (rewrite ...) [goal&gt; Goal false_true is proved <span class='goal' style='color: #AA0000'>goal</span> [any] false_true :<br>  (<span class='gf'>false</span> = <span class='gf'>true</span>) = <span class='gf'>false</span><br>Exiting proof mode.<br><br>Goal eq_true :<br>  (b = <span class='gf'>true</span>) = b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool[const]<br><span class='sep'>----------------------------------------</span><br>(b = <span class='gf'>true</span>) = b<br><br>[&gt; Line 42: by (case b) [goal&gt; Goal eq_true is proved <span class='goal' style='color: #AA0000'>goal</span> [any] eq_true :<br>  forall (b:bool), (b = <span class='gf'>true</span>) = b<br>Exiting proof mode.<br><br>Goal eq_true2 :<br>  (<span class='gf'>true</span> = b) = b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool[const]<br><span class='sep'>----------------------------------------</span><br>(<span class='gf'>true</span> = b) = b<br><br>[&gt; Line 46: by (case b) [goal&gt; Goal eq_true2 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] eq_true2 :<br>  forall (b:bool), (<span class='gf'>true</span> = b) = b<br>Exiting proof mode.<br><br><span class='goal' style='color: #AA0000'>axiom</span> [any] not_true :<br>  <span class='gf'>not</span> <span class='gf'>true</span> = <span class='gf'>false</span> <span class='goal' style='color: #AA0000'>axiom</span> [any] not_false :<br>                     <span class='gf'>not</span> <span class='gf'>false</span> = <span class='gf'>true</span><br>Goal not_not :<br>  <span class='gf'>not</span> (<span class='gf'>not</span> b) = b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool[const]<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> (<span class='gf'>not</span> b) = b<br><br>[&gt; Line 61: by (case b) [goal&gt; Goal not_not is proved <span class='goal' style='color: #AA0000'>goal</span> [any] not_not :<br>  forall (b:bool), <span class='gf'>not</span> (<span class='gf'>not</span> b) = b<br>Exiting proof mode.<br><br>Goal not_eq :<br>  <span class='gf'>not</span> (x = y) = (x &lt;&gt; y)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: x,y:&apos;a<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> (x = y) = (x &lt;&gt; y)<br><br>[&gt; Line 67: by (rewrite ...) [goal&gt; Goal not_eq is proved <span class='goal' style='color: #AA0000'>goal</span> [any] not_eq [&apos;a] :<br>  forall (x,y:&apos;a), <span class='gf'>not</span> (x = y) = (x &lt;&gt; y)<br>Exiting proof mode.<br><br>Goal not_neq :<br>  <span class='gf'>not</span> (x &lt;&gt; y) = (x = y)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: x,y:&apos;a<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> (x &lt;&gt; y) = (x = y)<br><br>[&gt; Line 73: by (rewrite ...) [goal&gt; Goal not_neq is proved <span class='goal' style='color: #AA0000'>goal</span> [any] not_neq [&apos;a] :<br>  forall (x,y:&apos;a), <span class='gf'>not</span> (x &lt;&gt; y) = (x = y)<br>Exiting proof mode.<br><br>Goal not_eqfalse :<br>  (b = <span class='gf'>false</span>) = <span class='gf'>not</span> b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool[const]<br><span class='sep'>----------------------------------------</span><br>(b = <span class='gf'>false</span>) = <span class='gf'>not</span> b<br><br>[&gt; Line 79: by (case b) [goal&gt; Goal not_eqfalse is proved <span class='goal' style='color: #AA0000'>goal</span> [any] not_eqfalse :<br>  forall (b:bool), (b = <span class='gf'>false</span>) = <span class='gf'>not</span> b<br>Exiting proof mode.<br><br>Goal not_impl :<br>  <span class='gf'>not</span> (a =&gt; b) = (a &amp;&amp; <span class='gf'>not</span> b)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool[const]<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> (a =&gt; b) = (a &amp;&amp; <span class='gf'>not</span> b)<br><br>[&gt; Line 84: ((rewrite ...);(split;(intro H))) [goal&gt; Focused goal (1/2):<br>System: any<br>Variables: a,b:bool[const]<br>H: <span class='gf'>not</span> (a =&gt; b)<br><span class='sep'>----------------------------------------</span><br>a &amp;&amp; <span class='gf'>not</span> b<br><br>[&gt; Line 85: split [goal&gt; Focused goal (1/3):<br>System: any<br>Variables: a,b:bool[const]<br>H: <span class='gf'>not</span> (a =&gt; b)<br><span class='sep'>----------------------------------------</span><br>a<br><br>[&gt; Line 86: (rewrite ...) [goal&gt; Focused goal (1/3):<br>System: any<br>Variables: a,b:bool[const]<br>H: <span class='gf'>not</span> (a =&gt; b)<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> (<span class='gf'>not</span> a)<br><br>[&gt; Line 87: (intro Hna) [goal&gt; Focused goal (1/3):<br>System: any<br>Variables: a,b:bool[const]<br>H: <span class='gf'>not</span> (a =&gt; b)<br>Hna: <span class='gf'>not</span> a<br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br>[&gt; Line 88: by (apply ... ) [goal&gt; Focused goal (1/2):<br>System: any<br>Variables: a,b:bool[const]<br>H: <span class='gf'>not</span> (a =&gt; b)<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> b<br><br>[&gt; Line 89: (intro Hb) [goal&gt; Focused goal (1/2):<br>System: any<br>Variables: a,b:bool[const]<br>H: <span class='gf'>not</span> (a =&gt; b)<br>Hb: b<br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br>[&gt; Line 90: by (apply ... ) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool[const]<br>H: a &amp;&amp; <span class='gf'>not</span> b<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> (a =&gt; b)<br><br>[&gt; Line 91: (intro Hi) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool[const]<br>H: a &amp;&amp; <span class='gf'>not</span> b<br>Hi: a =&gt; b<br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br>[&gt; Line 92: (destruct H, [Ha Hnb]) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool[const]<br>Ha: a<br>Hi: a =&gt; b<br>Hnb: <span class='gf'>not</span> b<br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br>[&gt; Line 93: (apply ... ) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool[const]<br>Ha: a<br>Hi: a =&gt; b<br>Hnb: <span class='gf'>not</span> b<br><span class='sep'>----------------------------------------</span><br>b<br><br>[&gt; Line 94: by (apply ... ) [goal&gt; Goal not_impl is proved <span class='goal' style='color: #AA0000'>goal</span> [any] not_impl :<br>  forall (a,b:bool), <span class='gf'>not</span> (a =&gt; b) = (a &amp;&amp; <span class='gf'>not</span> b)<br>Exiting proof mode.<br><br>Goal eq_false :<br>  ((x = y) = <span class='gf'>false</span>) = (x &lt;&gt; y)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: x,y:&apos;a<br><span class='sep'>----------------------------------------</span><br>((x = y) = <span class='gf'>false</span>) = (x &lt;&gt; y)<br><br>[&gt; Line 102: (rewrite ...) [goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: x,y:&apos;a<br><span class='sep'>----------------------------------------</span><br>((x = y) = <span class='gf'>false</span>) = <span class='gf'>not</span> (x = y)<br><br>[&gt; Line 102: ((case (= x y));(intro _)) [goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: &apos;a<br>Variables: x,y:&apos;a<br>_: x = y<br><span class='sep'>----------------------------------------</span><br>(<span class='gf'>true</span> = <span class='gf'>false</span>) = <span class='gf'>not</span> <span class='gf'>true</span><br><br>[&gt; Line 102: simpl [goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: &apos;a<br>Variables: x,y:&apos;a<br>_: x = y<br><span class='sep'>----------------------------------------</span><br><span class='gf'>true</span><br><br>[&gt; Line 102: auto [goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: x,y:&apos;a<br>_: <span class='gf'>not</span> (x = y)<br><span class='sep'>----------------------------------------</span><br>(<span class='gf'>false</span> = <span class='gf'>false</span>) = <span class='gf'>not</span> <span class='gf'>false</span><br><br>[&gt; Line 103: by (rewrite ...) [goal&gt; Goal eq_false is proved <span class='goal' style='color: #AA0000'>goal</span> [any] eq_false [&apos;a] :<br>  forall (x,y:&apos;a), ((x = y) = <span class='gf'>false</span>) = (x &lt;&gt; y)<br>Exiting proof mode.<br><br><span class='goal' style='color: #AA0000'>axiom</span> [any] and_comm :<br>  forall (b,b&apos;:bool), (b &amp;&amp; b&apos;) = (b&apos; &amp;&amp; b)<br><span class='goal' style='color: #AA0000'>axiom</span> [any] and_true_l :<br>  forall (b:bool), (<span class='gf'>true</span> &amp;&amp; b) = b<br>Goal and_true_r :<br>  (b &amp;&amp; <span class='gf'>true</span>) = b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool[const]<br><span class='sep'>----------------------------------------</span><br>(b &amp;&amp; <span class='gf'>true</span>) = b<br><br>[&gt; Line 116: by (rewrite ... ...) [goal&gt; Goal and_true_r is proved <span class='goal' style='color: #AA0000'>goal</span> [any] and_true_r :<br>  forall (b:bool), (b &amp;&amp; <span class='gf'>true</span>) = b<br>Exiting proof mode.<br><br><span class='goal' style='color: #AA0000'>axiom</span> [any] and_false_l :<br>  forall (b:bool), (<span class='gf'>false</span> &amp;&amp; b) = <span class='gf'>false</span><br>Goal and_false_r :<br>  (b &amp;&amp; <span class='gf'>false</span>) = <span class='gf'>false</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool[const]<br><span class='sep'>----------------------------------------</span><br>(b &amp;&amp; <span class='gf'>false</span>) = <span class='gf'>false</span><br><br>[&gt; Line 123: by (rewrite ... ...) [goal&gt; Goal and_false_r is proved <span class='goal' style='color: #AA0000'>goal</span> [any] and_false_r :<br>  forall (b:bool), (b &amp;&amp; <span class='gf'>false</span>) = <span class='gf'>false</span><br>Exiting proof mode.<br><br><span class='goal' style='color: #AA0000'>axiom</span> [any] or_comm :<br>  forall (b,b&apos;:bool), (b || b&apos;) = (b&apos; || b)<br><span class='goal' style='color: #AA0000'>axiom</span> [any] or_false_l :<br>  forall (b:bool), (<span class='gf'>false</span> || b) = b<br>Goal or_false_r :<br>  (b || <span class='gf'>false</span>) = b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool[const]<br><span class='sep'>----------------------------------------</span><br>(b || <span class='gf'>false</span>) = b<br><br>[&gt; Line 134: by (rewrite ... ...) [goal&gt; Goal or_false_r is proved <span class='goal' style='color: #AA0000'>goal</span> [any] or_false_r :<br>  forall (b:bool), (b || <span class='gf'>false</span>) = b<br>Exiting proof mode.<br><br><span class='goal' style='color: #AA0000'>axiom</span> [any] or_true_l :<br>  forall (b:bool), (<span class='gf'>true</span> || b) = <span class='gf'>true</span><br>Goal or_true_r :<br>  (b || <span class='gf'>true</span>) = <span class='gf'>true</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool[const]<br><span class='sep'>----------------------------------------</span><br>(b || <span class='gf'>true</span>) = <span class='gf'>true</span><br><br>[&gt; Line 141: by (rewrite ... ...) [goal&gt; Goal or_true_r is proved <span class='goal' style='color: #AA0000'>goal</span> [any] or_true_r :<br>  forall (b:bool), (b || <span class='gf'>true</span>) = <span class='gf'>true</span><br>Exiting proof mode.<br><br>Goal impl_charac :<br>  (b =&gt; b&apos;) = (<span class='gf'>not</span> b || b&apos;)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b,b&apos;:bool[const]<br><span class='sep'>----------------------------------------</span><br>(b =&gt; b&apos;) = (<span class='gf'>not</span> b || b&apos;)<br><br>[&gt; Line 148: (((rewrite ...);(split;((case b);(case b&apos;))));(intro //=)) [goal&gt; Goal impl_charac is proved <span class='goal' style='color: #AA0000'>goal</span> [any] impl_charac :<br>  forall (b,b&apos;:bool), (b =&gt; b&apos;) = (<span class='gf'>not</span> b || b&apos;)<br>Exiting proof mode.<br><br>Goal impl_false_l :<br>  (<span class='gf'>false</span> =&gt; b) = <span class='gf'>true</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool[const]<br><span class='sep'>----------------------------------------</span><br>(<span class='gf'>false</span> =&gt; b) = <span class='gf'>true</span><br><br>[&gt; Line 152: by ((rewrite ...);(case b)) [goal&gt; Goal impl_false_l is proved <span class='goal' style='color: #AA0000'>goal</span> [any] impl_false_l :<br>  forall (b:bool), (<span class='gf'>false</span> =&gt; b) = <span class='gf'>true</span><br>Exiting proof mode.<br><br>Goal impl_true_r :<br>  (b =&gt; <span class='gf'>true</span>) = <span class='gf'>true</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool[const]<br><span class='sep'>----------------------------------------</span><br>(b =&gt; <span class='gf'>true</span>) = <span class='gf'>true</span><br><br>[&gt; Line 156: auto [goal&gt; Goal impl_true_r is proved <span class='goal' style='color: #AA0000'>goal</span> [any] impl_true_r :<br>  forall (b:bool), (b =&gt; <span class='gf'>true</span>) = <span class='gf'>true</span><br>Exiting proof mode.<br><br>Goal impl_true_false :<br>  (<span class='gf'>true</span> =&gt; <span class='gf'>false</span>) = <span class='gf'>false</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br><span class='sep'>----------------------------------------</span><br>(<span class='gf'>true</span> =&gt; <span class='gf'>false</span>) = <span class='gf'>false</span><br><br>[&gt; Line 160: by (rewrite ...) [goal&gt; Goal impl_true_false is proved <span class='goal' style='color: #AA0000'>goal</span> [any] impl_true_false :<br>  (<span class='gf'>true</span> =&gt; <span class='gf'>false</span>) = <span class='gf'>false</span><br>Exiting proof mode.<br><br>Goal not_and :<br>  <span class='gf'>not</span> (a &amp;&amp; b) = (<span class='gf'>not</span> a || <span class='gf'>not</span> b)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool[const]<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> (a &amp;&amp; b) = (<span class='gf'>not</span> a || <span class='gf'>not</span> b)<br><br>[&gt; Line 168: (rewrite ...) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool[const]<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> (a &amp;&amp; b) &lt;=&gt; <span class='gf'>not</span> a || <span class='gf'>not</span> b<br><br>[&gt; Line 169: (((case a);(case b));(intro //=)) [goal&gt; Goal not_and is proved <span class='goal' style='color: #AA0000'>goal</span> [any] not_and :<br>  forall (a,b:bool), <span class='gf'>not</span> (a &amp;&amp; b) = (<span class='gf'>not</span> a || <span class='gf'>not</span> b)<br>Exiting proof mode.<br><br>Goal not_or :<br>  <span class='gf'>not</span> (a || b) = (<span class='gf'>not</span> a &amp;&amp; <span class='gf'>not</span> b)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool[const]<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> (a || b) = (<span class='gf'>not</span> a &amp;&amp; <span class='gf'>not</span> b)<br><br>[&gt; Line 174: (rewrite ...) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool[const]<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> (a || b) &lt;=&gt; <span class='gf'>not</span> a &amp;&amp; <span class='gf'>not</span> b<br><br>[&gt; Line 175: (((case a);(case b));(intro //=)) [goal&gt; Goal not_or is proved <span class='goal' style='color: #AA0000'>goal</span> [any] not_or :<br>  forall (a,b:bool), <span class='gf'>not</span> (a || b) = (<span class='gf'>not</span> a &amp;&amp; <span class='gf'>not</span> b)<br>Exiting proof mode.<br><br>Goal if_true :<br>  b =&gt; if b then x else y = x<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: b:bool[const],x,y:&apos;a<br><span class='sep'>----------------------------------------</span><br>b =&gt; if b then x else y = x<br><br>[&gt; Line 184: (intro *) [goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: b:bool[const],x,y:&apos;a<br>H: b<br><span class='sep'>----------------------------------------</span><br>if b then x else y = x<br><br>[&gt; Line 185: (case (if b x y)) [goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: &apos;a<br>Variables: b:bool[const],x,y:&apos;a<br>H: b<br><span class='sep'>----------------------------------------</span><br>b &amp;&amp; if b then x else y = x =&gt; x = x<br><br>[&gt; Line 186: auto [goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: b:bool[const],x,y:&apos;a<br>H: b<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> b &amp;&amp; if b then x else y = y =&gt; y = x<br><br>[&gt; Line 187: (intro [HH _]) [goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: b:bool[const],x,y:&apos;a<br>H: b<br>HH: <span class='gf'>not</span> b<br>_: if b then x else y = y<br><span class='sep'>----------------------------------------</span><br>y = x<br><br>[&gt; Line 187: by (have ... as ) [goal&gt; Goal if_true is proved <span class='goal' style='color: #AA0000'>goal</span> [any] if_true [&apos;a] :<br>  forall (b:bool,x,y:&apos;a), b =&gt; if b then x else y = x<br>Exiting proof mode.<br><br>Goal if_true0 :<br>  if <span class='gf'>true</span> then x else y = x<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: x,y:&apos;a<br><span class='sep'>----------------------------------------</span><br>if <span class='gf'>true</span> then x else y = x<br><br>[&gt; Line 193: by (rewrite ...) [goal&gt; Goal if_true0 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] if_true0 [&apos;a] :<br>  forall (x,y:&apos;a), if <span class='gf'>true</span> then x else y = x<br>Exiting proof mode.<br><br>Goal if_false :<br>  <span class='gf'>not</span> b =&gt; if b then x else y = y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: b:bool[const],x,y:&apos;a<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> b =&gt; if b then x else y = y<br><br>[&gt; Line 200: ((intro *);(case (if b x y))) [goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: &apos;a<br>Variables: b:bool[const],x,y:&apos;a<br>H: <span class='gf'>not</span> b<br><span class='sep'>----------------------------------------</span><br>b &amp;&amp; if b then x else y = x =&gt; x = y<br><br>[&gt; Line 201: (intro [H1 H2]) [goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: &apos;a<br>Variables: b:bool[const],x,y:&apos;a<br>H: <span class='gf'>not</span> b<br>H1: b<br>H2: if b then x else y = x<br><span class='sep'>----------------------------------------</span><br>x = y<br><br>[&gt; Line 202: by (rewrite ... in H2) [goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: b:bool[const],x,y:&apos;a<br>H: <span class='gf'>not</span> b<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> b &amp;&amp; if b then x else y = y =&gt; y = y<br><br>[&gt; Line 203: auto [goal&gt; Goal if_false is proved <span class='goal' style='color: #AA0000'>goal</span> [any] if_false [&apos;a] :<br>  forall (b:bool,x,y:&apos;a), <span class='gf'>not</span> b =&gt; if b then x else y = y<br>Exiting proof mode.<br><br>Goal if_false0 :<br>  if <span class='gf'>false</span> then x else y = y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: x,y:&apos;a<br><span class='sep'>----------------------------------------</span><br>if <span class='gf'>false</span> then x else y = y<br><br>[&gt; Line 209: by (rewrite ...) [goal&gt; Goal if_false0 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] if_false0 [&apos;a] :<br>  forall (x,y:&apos;a), if <span class='gf'>false</span> then x else y = y<br>Exiting proof mode.<br><br>Goal if_then_then :<br>  if b then if b&apos; then x else y else y = if (b &amp;&amp; b&apos;) then x else y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: b,b&apos;:bool[const],x,y:&apos;a<br><span class='sep'>----------------------------------------</span><br>if b then if b&apos; then x else y else y = if (b &amp;&amp; b&apos;) then x else y<br><br>[&gt; Line 216: by ((case b);(case b&apos;)) [goal&gt; Goal if_then_then is proved <span class='goal' style='color: #AA0000'>goal</span> [any] if_then_then [&apos;a] :<br>  forall (b,b&apos;:bool,x,y:&apos;a),<br>    if b then if b&apos; then x else y else y = if (b &amp;&amp; b&apos;) then x else y<br>Exiting proof mode.<br><br>Goal if_then_implies :<br>  if b then if b&apos; then x else y else z =<br>  if b then if (b =&gt; b&apos;) then x else y else z<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: b,b&apos;:bool[const],x,y,z:&apos;a<br><span class='sep'>----------------------------------------</span><br>if b then if b&apos; then x else y else z =<br>if b then if (b =&gt; b&apos;) then x else y else z<br><br>[&gt; Line 223: ((case b);<br>             ((intro H);((case b&apos;);((intro H&apos;);(simpl;(try auto))))))<br>[goal&gt; Goal if_then_implies is proved <span class='goal' style='color: #AA0000'>goal</span> [any] if_then_implies [&apos;a] :<br>  forall (b,b&apos;:bool,x,y,z:&apos;a),<br>    if b then if b&apos; then x else y else z =<br>    if b then if (b =&gt; b&apos;) then x else y else z<br>Exiting proof mode.<br><br>Goal if_same :<br>  if b then x else x = x<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: b:bool[const],x:&apos;a<br><span class='sep'>----------------------------------------</span><br>if b then x else x = x<br><br>[&gt; Line 229: by (case b) [goal&gt; Goal if_same is proved <span class='goal' style='color: #AA0000'>goal</span> [any] if_same [&apos;a] :<br>  forall (b:bool,x:&apos;a), if b then x else x = x<br>Exiting proof mode.<br><br>Goal if_then :<br>  b = b&apos; =&gt; if b then if b&apos; then x else y else z = if b then x else z<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: b,b&apos;:bool[const],x,y,z:&apos;a<br><span class='sep'>----------------------------------------</span><br>b = b&apos; =&gt; if b then if b&apos; then x else y else z = if b then x else z<br><br>[&gt; Line 238: by ((intro -&gt;);(case b&apos;)) [goal&gt; Goal if_then is proved <span class='goal' style='color: #AA0000'>goal</span> [any] if_then [&apos;a] :<br>  forall (b,b&apos;:bool,x,y,z:&apos;a),<br>    b = b&apos; =&gt; if b then if b&apos; then x else y else z = if b then x else z<br>Exiting proof mode.<br><br>Goal if_else :<br>  b = b&apos; =&gt; if b then x else if b&apos; then y else z = if b then x else z<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: b,b&apos;:bool[const],x,y,z:&apos;a<br><span class='sep'>----------------------------------------</span><br>b = b&apos; =&gt; if b then x else if b&apos; then y else z = if b then x else z<br><br>[&gt; Line 247: by ((intro -&gt;);(case b&apos;)) [goal&gt; Goal if_else is proved <span class='goal' style='color: #AA0000'>goal</span> [any] if_else [&apos;a] :<br>  forall (b,b&apos;:bool,x,y,z:&apos;a),<br>    b = b&apos; =&gt; if b then x else if b&apos; then y else z = if b then x else z<br>Exiting proof mode.<br><br>Goal if_then_not :<br>  b = <span class='gf'>not</span> b&apos; =&gt; if b then if b&apos; then x else y else z = if b then y else z<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: b,b&apos;:bool[const],x,y,z:&apos;a<br><span class='sep'>----------------------------------------</span><br>b = <span class='gf'>not</span> b&apos; =&gt; if b then if b&apos; then x else y else z = if b then y else z<br><br>[&gt; Line 256: by ((intro -&gt;);(case b&apos;)) [goal&gt; Goal if_then_not is proved <span class='goal' style='color: #AA0000'>goal</span> [any] if_then_not [&apos;a] :<br>  forall (b,b&apos;:bool,x,y,z:&apos;a),<br>    b = <span class='gf'>not</span> b&apos; =&gt; if b then if b&apos; then x else y else z = if b then y else z<br>Exiting proof mode.<br><br>Goal if_else_not :<br>  b = <span class='gf'>not</span> b&apos; =&gt; if b then x else if b&apos; then y else z = if b then x else y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: b,b&apos;:bool[const],x,y,z:&apos;a<br><span class='sep'>----------------------------------------</span><br>b = <span class='gf'>not</span> b&apos; =&gt; if b then x else if b&apos; then y else z = if b then x else y<br><br>[&gt; Line 265: by ((intro -&gt;);(case b&apos;)) [goal&gt; Goal if_else_not is proved <span class='goal' style='color: #AA0000'>goal</span> [any] if_else_not [&apos;a] :<br>  forall (b,b&apos;:bool,x,y,z:&apos;a),<br>    b = <span class='gf'>not</span> b&apos; =&gt; if b then x else if b&apos; then y else z = if b then x else y<br>Exiting proof mode.<br><br>Goal fst_pair :<br>  <span class='gf'>fst</span> &lt;x,y&gt; = x<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:message<br><span class='sep'>----------------------------------------</span><br><span class='gf'>fst</span> &lt;x,y&gt; = x<br><br>[&gt; Line 273: auto [goal&gt; Goal fst_pair is proved <span class='goal' style='color: #AA0000'>goal</span> [any] fst_pair :<br>  forall (x,y:message), <span class='gf'>fst</span> &lt;x,y&gt; = x<br>Exiting proof mode.<br><br>Goal snd_pair :<br>  <span class='gf'>snd</span> &lt;x,y&gt; = y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:message<br><span class='sep'>----------------------------------------</span><br><span class='gf'>snd</span> &lt;x,y&gt; = y<br><br>[&gt; Line 277: auto [goal&gt; Goal snd_pair is proved <span class='goal' style='color: #AA0000'>goal</span> [any] snd_pair :<br>  forall (x,y:message), <span class='gf'>snd</span> &lt;x,y&gt; = y<br>Exiting proof mode.<br><br>Goal iff_def :<br>  (x &lt;=&gt; y) = ((x =&gt; y) &amp;&amp; (y =&gt; x))<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:bool[const]<br><span class='sep'>----------------------------------------</span><br>(x &lt;=&gt; y) = ((x =&gt; y) &amp;&amp; (y =&gt; x))<br><br>[&gt; Line 285: ((rewrite ...);split) [goal&gt; Focused goal (1/2):<br>System: any<br>Variables: x,y:bool[const]<br><span class='sep'>----------------------------------------</span><br>x &lt;=&gt; y =&gt; (x =&gt; y) &amp;&amp; (y =&gt; x)<br><br>[&gt; Line 286: by (intro -&gt;) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:bool[const]<br><span class='sep'>----------------------------------------</span><br>(x =&gt; y) &amp;&amp; (y =&gt; x) =&gt; x &lt;=&gt; y<br><br>[&gt; Line 287: auto [goal&gt; Goal iff_def is proved <span class='goal' style='color: #AA0000'>goal</span> [any] iff_def :<br>  forall (x,y:bool), (x &lt;=&gt; y) = ((x =&gt; y) &amp;&amp; (y =&gt; x))<br>Exiting proof mode.<br><br>Goal iff_refl :<br>  (x &lt;=&gt; x) = <span class='gf'>true</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x:bool[const]<br><span class='sep'>----------------------------------------</span><br>(x &lt;=&gt; x) = <span class='gf'>true</span><br><br>[&gt; Line 292: by (rewrite ...) [goal&gt; Goal iff_refl is proved <span class='goal' style='color: #AA0000'>goal</span> [any] iff_refl :<br>  forall (x:bool), (x &lt;=&gt; x) = <span class='gf'>true</span><br>Exiting proof mode.<br><br>Goal iff_sym :<br>  (x &lt;=&gt; y) = (y &lt;=&gt; x)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:bool[const]<br><span class='sep'>----------------------------------------</span><br>(x &lt;=&gt; y) = (y &lt;=&gt; x)<br><br>[&gt; Line 298: by (rewrite ... ...) [goal&gt; Goal iff_sym is proved <span class='goal' style='color: #AA0000'>goal</span> [any] iff_sym :<br>  forall (x,y:bool), (x &lt;=&gt; y) = (y &lt;=&gt; x)<br>Exiting proof mode.<br><br>Goal true_iff_false :<br>  (<span class='gf'>true</span> &lt;=&gt; <span class='gf'>false</span>) = <span class='gf'>false</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br><span class='sep'>----------------------------------------</span><br>(<span class='gf'>true</span> &lt;=&gt; <span class='gf'>false</span>) = <span class='gf'>false</span><br><br>[&gt; Line 303: by (rewrite ...) [goal&gt; Goal true_iff_false is proved <span class='goal' style='color: #AA0000'>goal</span> [any] true_iff_false :<br>  (<span class='gf'>true</span> &lt;=&gt; <span class='gf'>false</span>) = <span class='gf'>false</span><br>Exiting proof mode.<br><br>Goal false_iff_true :<br>  (<span class='gf'>false</span> &lt;=&gt; <span class='gf'>true</span>) = <span class='gf'>false</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br><span class='sep'>----------------------------------------</span><br>(<span class='gf'>false</span> &lt;=&gt; <span class='gf'>true</span>) = <span class='gf'>false</span><br><br>[&gt; Line 309: by (rewrite ...) [goal&gt; Goal false_iff_true is proved <span class='goal' style='color: #AA0000'>goal</span> [any] false_iff_true :<br>  (<span class='gf'>false</span> &lt;=&gt; <span class='gf'>true</span>) = <span class='gf'>false</span><br>Exiting proof mode.<br><br>Goal exists_false1 :<br>  (exists (a:&apos;a), <span class='gf'>false</span>) = <span class='gf'>false</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br><span class='sep'>----------------------------------------</span><br>(exists (a:&apos;a), <span class='gf'>false</span>) = <span class='gf'>false</span><br><br>[&gt; Line 321: by (rewrite ...) [goal&gt; Goal exists_false1 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] exists_false1 [&apos;a] :<br>  (exists (a:&apos;a), <span class='gf'>false</span>) = <span class='gf'>false</span><br>Exiting proof mode.<br><br>Goal exists_false2 :<br>  (exists (a:&apos;a,b:&apos;b), <span class='gf'>false</span>) = <span class='gf'>false</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a, &apos;b<br><span class='sep'>----------------------------------------</span><br>(exists (a:&apos;a,b:&apos;b), <span class='gf'>false</span>) = <span class='gf'>false</span><br><br>[&gt; Line 325: by (rewrite ...) [goal&gt; Goal exists_false2 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] exists_false2 [&apos;a &apos;b] :<br>  (exists (a:&apos;a,b:&apos;b), <span class='gf'>false</span>) = <span class='gf'>false</span><br>Exiting proof mode.<br><br>Goal exists_false3 :<br>  (exists (a:&apos;a,b:&apos;b,c:&apos;c), <span class='gf'>false</span>) = <span class='gf'>false</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a, &apos;b, &apos;c<br><span class='sep'>----------------------------------------</span><br>(exists (a:&apos;a,b:&apos;b,c:&apos;c), <span class='gf'>false</span>) = <span class='gf'>false</span><br><br>[&gt; Line 329: by (rewrite ...) [goal&gt; Goal exists_false3 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] exists_false3 [&apos;a &apos;b &apos;c] :<br>  (exists (a:&apos;a,b:&apos;b,c:&apos;c), <span class='gf'>false</span>) = <span class='gf'>false</span><br>Exiting proof mode.<br><br>Goal exists_false4 :<br>  (exists (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d), <span class='gf'>false</span>) = <span class='gf'>false</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a, &apos;b, &apos;c, &apos;d<br><span class='sep'>----------------------------------------</span><br>(exists (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d), <span class='gf'>false</span>) = <span class='gf'>false</span><br><br>[&gt; Line 333: by (rewrite ...) [goal&gt; Goal exists_false4 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] exists_false4 [&apos;a &apos;b &apos;c &apos;d] :<br>  (exists (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d), <span class='gf'>false</span>) = <span class='gf'>false</span><br>Exiting proof mode.<br><br>Goal exists_false5 :<br>  (exists (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d,e:&apos;e), <span class='gf'>false</span>) = <span class='gf'>false</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a, &apos;b, &apos;c, &apos;d, &apos;e<br><span class='sep'>----------------------------------------</span><br>(exists (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d,e:&apos;e), <span class='gf'>false</span>) = <span class='gf'>false</span><br><br>[&gt; Line 337: by (rewrite ...) [goal&gt; Goal exists_false5 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] exists_false5 [&apos;a &apos;b &apos;c &apos;d &apos;e] :<br>  (exists (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d,e:&apos;e), <span class='gf'>false</span>) = <span class='gf'>false</span><br>Exiting proof mode.<br><br>Goal exists_false6 :<br>  (exists (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d,e:&apos;e,f:&apos;f), <span class='gf'>false</span>) = <span class='gf'>false</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a, &apos;b, &apos;c, &apos;d, &apos;e, &apos;f<br><span class='sep'>----------------------------------------</span><br>(exists (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d,e:&apos;e,f:&apos;f), <span class='gf'>false</span>) = <span class='gf'>false</span><br><br>[&gt; Line 341: by (rewrite ...) [goal&gt; Goal exists_false6 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] exists_false6 [&apos;a &apos;b &apos;c &apos;d &apos;e &apos;f] :<br>  (exists (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d,e:&apos;e,f:&apos;f), <span class='gf'>false</span>) = <span class='gf'>false</span><br>Exiting proof mode.<br><br>Goal forall_true1 :<br>  (forall (a:&apos;a), <span class='gf'>true</span>) = <span class='gf'>true</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br><span class='sep'>----------------------------------------</span><br>(forall (a:&apos;a), <span class='gf'>true</span>) = <span class='gf'>true</span><br><br>[&gt; Line 351: auto [goal&gt; Goal forall_true1 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] forall_true1 [&apos;a] :<br>  (forall (a:&apos;a), <span class='gf'>true</span>) = <span class='gf'>true</span><br>Exiting proof mode.<br><br>Goal forall_true2 :<br>  (forall (a:&apos;a,b:&apos;b), <span class='gf'>true</span>) = <span class='gf'>true</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a, &apos;b<br><span class='sep'>----------------------------------------</span><br>(forall (a:&apos;a,b:&apos;b), <span class='gf'>true</span>) = <span class='gf'>true</span><br><br>[&gt; Line 355: auto [goal&gt; Goal forall_true2 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] forall_true2 [&apos;a &apos;b] :<br>  (forall (a:&apos;a,b:&apos;b), <span class='gf'>true</span>) = <span class='gf'>true</span><br>Exiting proof mode.<br><br>Goal forall_true3 :<br>  (forall (a:&apos;a,b:&apos;b,c:&apos;c), <span class='gf'>true</span>) = <span class='gf'>true</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a, &apos;b, &apos;c<br><span class='sep'>----------------------------------------</span><br>(forall (a:&apos;a,b:&apos;b,c:&apos;c), <span class='gf'>true</span>) = <span class='gf'>true</span><br><br>[&gt; Line 359: auto [goal&gt; Goal forall_true3 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] forall_true3 [&apos;a &apos;b &apos;c] :<br>  (forall (a:&apos;a,b:&apos;b,c:&apos;c), <span class='gf'>true</span>) = <span class='gf'>true</span><br>Exiting proof mode.<br><br>Goal forall_true4 :<br>  (forall (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d), <span class='gf'>true</span>) = <span class='gf'>true</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a, &apos;b, &apos;c, &apos;d<br><span class='sep'>----------------------------------------</span><br>(forall (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d), <span class='gf'>true</span>) = <span class='gf'>true</span><br><br>[&gt; Line 363: auto [goal&gt; Goal forall_true4 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] forall_true4 [&apos;a &apos;b &apos;c &apos;d] :<br>  (forall (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d), <span class='gf'>true</span>) = <span class='gf'>true</span><br>Exiting proof mode.<br><br>Goal forall_true5 :<br>  (forall (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d,e:&apos;e), <span class='gf'>true</span>) = <span class='gf'>true</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a, &apos;b, &apos;c, &apos;d, &apos;e<br><span class='sep'>----------------------------------------</span><br>(forall (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d,e:&apos;e), <span class='gf'>true</span>) = <span class='gf'>true</span><br><br>[&gt; Line 367: auto [goal&gt; Goal forall_true5 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] forall_true5 [&apos;a &apos;b &apos;c &apos;d &apos;e] :<br>  (forall (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d,e:&apos;e), <span class='gf'>true</span>) = <span class='gf'>true</span><br>Exiting proof mode.<br><br>Goal forall_true6 :<br>  (forall (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d,e:&apos;e,f:&apos;f), <span class='gf'>true</span>) = <span class='gf'>true</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a, &apos;b, &apos;c, &apos;d, &apos;e, &apos;f<br><span class='sep'>----------------------------------------</span><br>(forall (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d,e:&apos;e,f:&apos;f), <span class='gf'>true</span>) = <span class='gf'>true</span><br><br>[&gt; Line 371: auto [goal&gt; Goal forall_true6 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] forall_true6 [&apos;a &apos;b &apos;c &apos;d &apos;e &apos;f] :<br>  (forall (a:&apos;a,b:&apos;b,c:&apos;c,d:&apos;d,e:&apos;e,f:&apos;f), <span class='gf'>true</span>) = <span class='gf'>true</span><br>Exiting proof mode.<br><br><span class='goal' style='color: #AA0000'>axiom</span> [any] len_zeroes :<br>  forall (x:message), <span class='gf'>len</span> (<span class='gf'>zeroes</span> x) = <span class='gf'>len</span> x<br><span class='goal' style='color: #AA0000'>axiom</span> [any] exec_not_init :<br>  forall (tau:timestamp),<br>    <span class='ga'>init</span> &lt; tau =&gt; <span class='gm'>exec</span>@tau = (<span class='gm'>exec</span>@<span class='gf'>pred</span> tau &amp;&amp; <span class='gm'>cond</span>@tau)<br><span class='goal' style='color: #AA0000'>axiom</span> [any] exec_init :<br>  forall (tau:timestamp), tau = <span class='ga'>init</span> =&gt; <span class='gm'>exec</span>@tau = <span class='gf'>true</span><br><span class='goal' style='color: #AA0000'>axiom</span> [any] cond_init :<br>  forall (tau:timestamp), tau = <span class='ga'>init</span> =&gt; <span class='gm'>cond</span>@tau = <span class='gf'>true</span><br>Goal exec_le :<br>  tau&apos; &lt;= tau =&gt; <span class='gm'>exec</span>@tau =&gt; <span class='gm'>exec</span>@tau&apos;<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: tau,tau&apos;:timestamp[const]<br><span class='sep'>----------------------------------------</span><br>tau&apos; &lt;= tau =&gt; <span class='gm'>exec</span>@tau =&gt; <span class='gm'>exec</span>@tau&apos;<br><br>[&gt; Line 395: ((induction tau);(intro tau IH Hle Hexec)) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: tau,tau&apos;:timestamp[const]<br>Hexec: <span class='gm'>exec</span>@tau<br>Hle: tau&apos; &lt;= tau<br>IH: forall (tau0:timestamp),<br>      tau0 &lt; tau =&gt; tau&apos; &lt;= tau0 =&gt; <span class='gm'>exec</span>@tau0 =&gt; <span class='gm'>exec</span>@tau&apos;<br><span class='sep'>----------------------------------------</span><br><span class='gm'>exec</span>@tau&apos;<br><br>[&gt; Line 396: (case (= tau tau&apos;)) [goal&gt; Focused goal (1/2):<br>System: any<br>Variables: tau,tau&apos;:timestamp[const]<br>Hexec: <span class='gm'>exec</span>@tau<br>Hle: tau&apos; &lt;= tau<br>IH: forall (tau0:timestamp),<br>      tau0 &lt; tau =&gt; tau&apos; &lt;= tau0 =&gt; <span class='gm'>exec</span>@tau0 =&gt; <span class='gm'>exec</span>@tau&apos;<br><span class='sep'>----------------------------------------</span><br>tau = tau&apos; =&gt; <span class='gm'>exec</span>@tau&apos;<br><br>[&gt; Line 397: auto [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: tau,tau&apos;:timestamp[const]<br>Hexec: <span class='gm'>exec</span>@tau<br>Hle: tau&apos; &lt;= tau<br>IH: forall (tau0:timestamp),<br>      tau0 &lt; tau =&gt; tau&apos; &lt;= tau0 =&gt; <span class='gm'>exec</span>@tau0 =&gt; <span class='gm'>exec</span>@tau&apos;<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> (tau = tau&apos;) =&gt; <span class='gm'>exec</span>@tau&apos;<br><br>[&gt; Line 398: (intro Hneq) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: tau,tau&apos;:timestamp[const]<br>Hexec: <span class='gm'>exec</span>@tau<br>Hle: tau&apos; &lt;= tau<br>Hneq: <span class='gf'>not</span> (tau = tau&apos;)<br>IH: forall (tau0:timestamp),<br>      tau0 &lt; tau =&gt; tau&apos; &lt;= tau0 =&gt; <span class='gm'>exec</span>@tau0 =&gt; <span class='gm'>exec</span>@tau&apos;<br><span class='sep'>----------------------------------------</span><br><span class='gm'>exec</span>@tau&apos;<br><br>[&gt; Line 399: (rewrite ... // in Hexec) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: tau,tau&apos;:timestamp[const]<br>Hexec: <span class='gm'>exec</span>@<span class='gf'>pred</span> tau &amp;&amp; <span class='gm'>cond</span>@tau<br>Hle: tau&apos; &lt;= tau<br>Hneq: <span class='gf'>not</span> (tau = tau&apos;)<br>IH: forall (tau0:timestamp),<br>      tau0 &lt; tau =&gt; tau&apos; &lt;= tau0 =&gt; <span class='gm'>exec</span>@tau0 =&gt; <span class='gm'>exec</span>@tau&apos;<br><span class='sep'>----------------------------------------</span><br><span class='gm'>exec</span>@tau&apos;<br><br>[&gt; Line 400: by (apply ... ) [goal&gt; Goal exec_le is proved <span class='goal' style='color: #AA0000'>goal</span> [any] exec_le :<br>  forall (tau,tau&apos;:timestamp), tau&apos; &lt;= tau =&gt; <span class='gm'>exec</span>@tau =&gt; <span class='gm'>exec</span>@tau&apos;<br>Exiting proof mode.<br><br>Goal exec_cond :<br>  <span class='gm'>happens</span>(tau) =&gt; <span class='gm'>exec</span>@tau =&gt; <span class='gm'>cond</span>@tau<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: tau:timestamp[const]<br><span class='sep'>----------------------------------------</span><br><span class='gm'>happens</span>(tau) =&gt; <span class='gm'>exec</span>@tau =&gt; <span class='gm'>cond</span>@tau<br><br>[&gt; Line 405: (intro Hap Hexec) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: tau:timestamp[const]<br>Hap: <span class='gm'>happens</span>(tau)<br>Hexec: <span class='gm'>exec</span>@tau<br><span class='sep'>----------------------------------------</span><br><span class='gm'>cond</span>@tau<br><br>[&gt; Line 406: ((case (&lt; init tau));(intro _)) [goal&gt; Focused goal (1/2):<br>System: any<br>Variables: tau:timestamp[const]<br>Hap: <span class='gm'>happens</span>(tau)<br>Hexec: <span class='gm'>exec</span>@tau<br>_: <span class='ga'>init</span> &lt; tau<br><span class='sep'>----------------------------------------</span><br><span class='gm'>cond</span>@tau<br><br>[&gt; Line 407: by (rewrite ... in Hexec) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: tau:timestamp[const]<br>Hap: <span class='gm'>happens</span>(tau)<br>Hexec: <span class='gm'>exec</span>@tau<br>_: <span class='gf'>not</span> (<span class='ga'>init</span> &lt; tau)<br><span class='sep'>----------------------------------------</span><br><span class='gm'>cond</span>@tau<br><br>[&gt; Line 408: by (rewrite ...) [goal&gt; Goal exec_cond is proved <span class='goal' style='color: #AA0000'>goal</span> [any] exec_cond :<br>  forall (tau:timestamp), <span class='gm'>happens</span>(tau) =&gt; <span class='gm'>exec</span>@tau =&gt; <span class='gm'>cond</span>@tau<br>Exiting proof mode.<br><br>Goal f_apply :<br>  x = y =&gt; f x = f y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a, &apos;b<br>Variables: f:&apos;a -&gt; &apos;b,x,y:&apos;a<br><span class='sep'>----------------------------------------</span><br>x = y =&gt; f x = f y<br><br>[&gt; Line 414: by (intro -&gt;) [goal&gt; Goal f_apply is proved <span class='goal' style='color: #AA0000'>goal</span> [any] f_apply [&apos;a &apos;b] :<br>  forall (f:&apos;a -&gt; &apos;b,x,y:&apos;a), x = y =&gt; f x = f y<br>Exiting proof mode.<br><br>Goal not_exists_1 :<br>  <span class='gf'>not</span> exists (a:&apos;a), phi a = forall (a:&apos;a), <span class='gf'>not</span> (phi a)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: phi:&apos;a -&gt; bool<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> exists (a:&apos;a), phi a = forall (a:&apos;a), <span class='gf'>not</span> (phi a)<br><br>[&gt; Line 419: (rewrite ...) [goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: phi:&apos;a -&gt; bool<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> exists (a:&apos;a), phi a &lt;=&gt; forall (a:&apos;a), <span class='gf'>not</span> (phi a)<br><br>[&gt; Line 420: split [goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: &apos;a<br>Variables: phi:&apos;a -&gt; bool<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> exists (a:&apos;a), phi a =&gt; forall (a:&apos;a), <span class='gf'>not</span> (phi a)<br><br>[&gt; Line 421: (intro H a Hp) [goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: &apos;a<br>Variables: a:&apos;a,phi:&apos;a -&gt; bool<br>H: <span class='gf'>not</span> exists (a:&apos;a), phi a<br>Hp: phi a<br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br>[&gt; Line 422: (apply ... ) [goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: &apos;a<br>Variables: a:&apos;a,phi:&apos;a -&gt; bool<br>H: <span class='gf'>not</span> exists (a:&apos;a), phi a<br>Hp: phi a<br><span class='sep'>----------------------------------------</span><br>exists (a:&apos;a), phi a<br><br>[&gt; Line 423: by (exists a) [goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: phi:&apos;a -&gt; bool<br><span class='sep'>----------------------------------------</span><br>(forall (a:&apos;a), <span class='gf'>not</span> (phi a)) =&gt; <span class='gf'>not</span> exists (a:&apos;a), phi a<br><br>[&gt; Line 424: (intro H [a Hp]) [goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a<br>Variables: a:&apos;a,phi:&apos;a -&gt; bool<br>H: forall (a:&apos;a), <span class='gf'>not</span> (phi a)<br>Hp: phi a<br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br>[&gt; Line 425: by (have ... as ) [goal&gt; Goal not_exists_1 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] not_exists_1 [&apos;a] :<br>  forall (phi:&apos;a -&gt; bool),<br>    <span class='gf'>not</span> exists (a:&apos;a), phi a = forall (a:&apos;a), <span class='gf'>not</span> (phi a)<br>Exiting proof mode.<br><br>Goal not_exists_2 :<br>  <span class='gf'>not</span> exists (a:&apos;a,b:&apos;b), phi a b = forall (a:&apos;a,b:&apos;b), <span class='gf'>not</span> (phi a b)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a, &apos;b<br>Variables: phi:&apos;a -&gt; &apos;b -&gt; bool<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> exists (a:&apos;a,b:&apos;b), phi a b = forall (a:&apos;a,b:&apos;b), <span class='gf'>not</span> (phi a b)<br><br>[&gt; Line 431: (rewrite ...) [goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a, &apos;b<br>Variables: phi:&apos;a -&gt; &apos;b -&gt; bool<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> exists (a:&apos;a,b:&apos;b), phi a b &lt;=&gt; forall (a:&apos;a,b:&apos;b), <span class='gf'>not</span> (phi a b)<br><br>[&gt; Line 432: split [goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: &apos;a, &apos;b<br>Variables: phi:&apos;a -&gt; &apos;b -&gt; bool<br><span class='sep'>----------------------------------------</span><br><span class='gf'>not</span> exists (a:&apos;a,b:&apos;b), phi a b =&gt; forall (a:&apos;a,b:&apos;b), <span class='gf'>not</span> (phi a b)<br><br>[&gt; Line 433: (intro H a b Hp) [goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: &apos;a, &apos;b<br>Variables: a:&apos;a,b:&apos;b,phi:&apos;a -&gt; &apos;b -&gt; bool<br>H: <span class='gf'>not</span> exists (a:&apos;a,b:&apos;b), phi a b<br>Hp: phi a b<br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br>[&gt; Line 434: (apply ... ) [goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: &apos;a, &apos;b<br>Variables: a:&apos;a,b:&apos;b,phi:&apos;a -&gt; &apos;b -&gt; bool<br>H: <span class='gf'>not</span> exists (a:&apos;a,b:&apos;b), phi a b<br>Hp: phi a b<br><span class='sep'>----------------------------------------</span><br>exists (a:&apos;a,b:&apos;b), phi a b<br><br>[&gt; Line 435: by (exists a, b) [goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a, &apos;b<br>Variables: phi:&apos;a -&gt; &apos;b -&gt; bool<br><span class='sep'>----------------------------------------</span><br>(forall (a:&apos;a,b:&apos;b), <span class='gf'>not</span> (phi a b)) =&gt; <span class='gf'>not</span> exists (a:&apos;a,b:&apos;b), phi a b<br><br>[&gt; Line 436: (intro H [a b Hp]) [goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: &apos;a, &apos;b<br>Variables: a:&apos;a,b:&apos;b,phi:&apos;a -&gt; &apos;b -&gt; bool<br>H: forall (a:&apos;a,b:&apos;b), <span class='gf'>not</span> (phi a b)<br>Hp: phi a b<br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br>[&gt; Line 437: by (have ... as ) [goal&gt; Goal not_exists_2 is proved <span class='goal' style='color: #AA0000'>goal</span> [any] not_exists_2 [&apos;a &apos;b] :<br>  forall (phi:&apos;a -&gt; &apos;b -&gt; bool),<br>    <span class='gf'>not</span> exists (a:&apos;a,b:&apos;b), phi a b = forall (a:&apos;a,b:&apos;b), <span class='gf'>not</span> (phi a b)<br>Exiting proof mode.<br><br><span class='goal' style='color: #AA0000'>axiom</span> [any] not_forall_1 [&apos;a] :<br>  forall (phi:&apos;a -&gt; bool),<br>    <span class='gf'>not</span> forall (a:&apos;a), phi a = exists (a:&apos;a), <span class='gf'>not</span> (phi a)<br><span class='goal' style='color: #AA0000'>axiom</span> [any] not_forall_2 [&apos;a &apos;b] :<br>  forall (phi:&apos;a -&gt; &apos;b -&gt; bool),<br>    <span class='gf'>not</span> forall (a:&apos;a,b:&apos;b), phi a b = exists (a:&apos;a,b:&apos;b), <span class='gf'>not</span> (phi a b)<br>[warning&gt;loaded: Basic.sp<br>&lt;]</span>
</span>

<span class="squirrel-step" id="step28">
<span class="input-line" id="in28"><br><br>abstract Some : message -&gt; message.</span>
<span class="output-line" id="out28"></span>
</span>

<span class="squirrel-step" id="step29">
<span class="input-line" id="in29"><br>abstract None : message.</span>
<span class="output-line" id="out29"></span>
</span>

<span class="squirrel-step" id="step30">
<span class="input-line" id="in30"><br>abstract oget : message -&gt; message.</span>
<span class="output-line" id="out30"></span>
</span>

<span class="squirrel-step" id="step31">
<span class="input-line" id="in31"><br>include Lib.</span>
<span class="output-line" id="out31">Goal mult_left_apply :<br>  y = z =&gt; a ** y = a ** z<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,y,z:E<br><span class='sep'>----------------------------------------</span><br>y = z =&gt; a ** y = a ** z<br><br>[&gt; Line 5: auto [goal&gt; Goal mult_left_apply is proved <span class='goal' style='color: #AA0000'>goal</span> [any] mult_left_apply :<br>  forall (a,y,z:E), y = z =&gt; a ** y = a ** z<br>Exiting proof mode.<br><br>Goal pair_eq_pair :<br>  (&lt;x,y&gt; = &lt;x&apos;,y&apos;&gt;) = (x = x&apos; &amp;&amp; y = y&apos;)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,x&apos;,y,y&apos;:message<br><span class='sep'>----------------------------------------</span><br>(&lt;x,y&gt; = &lt;x&apos;,y&apos;&gt;) = (x = x&apos; &amp;&amp; y = y&apos;)<br><br>[&gt; Line 13: ((rewrite ...);(split;(intro H))) [goal&gt; Focused goal (1/2):<br>System: any<br>Variables: x,x&apos;,y,y&apos;:message<br>H: &lt;x,y&gt; = &lt;x&apos;,y&apos;&gt;<br><span class='sep'>----------------------------------------</span><br>x = x&apos; &amp;&amp; y = y&apos;<br><br>[&gt; Line 14: split [goal&gt; Focused goal (1/3):<br>System: any<br>Variables: x,x&apos;,y,y&apos;:message<br>H: &lt;x,y&gt; = &lt;x&apos;,y&apos;&gt;<br><span class='sep'>----------------------------------------</span><br>x = x&apos;<br><br>[&gt; Line 15: by (apply ...  in H) [goal&gt; Focused goal (1/2):<br>System: any<br>Variables: x,x&apos;,y,y&apos;:message<br>H: &lt;x,y&gt; = &lt;x&apos;,y&apos;&gt;<br><span class='sep'>----------------------------------------</span><br>y = y&apos;<br><br>[&gt; Line 16: by (apply ...  in H) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,x&apos;,y,y&apos;:message<br>H: x = x&apos; &amp;&amp; y = y&apos;<br><span class='sep'>----------------------------------------</span><br>&lt;x,y&gt; = &lt;x&apos;,y&apos;&gt;<br><br>[&gt; Line 17: auto [goal&gt; Goal pair_eq_pair is proved <span class='goal' style='color: #AA0000'>goal</span> [any] pair_eq_pair :<br>  forall (x,y,x&apos;,y&apos;:message), (&lt;x,y&gt; = &lt;x&apos;,y&apos;&gt;) = (x = x&apos; &amp;&amp; y = y&apos;)<br>Exiting proof mode.<br><br>Goal le_pred_lt :<br>  t &lt;= <span class='gf'>pred</span> t&apos; = t &lt; t&apos;<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: t,t&apos;:timestamp[const]<br><span class='sep'>----------------------------------------</span><br>t &lt;= <span class='gf'>pred</span> t&apos; = t &lt; t&apos;<br><br>[&gt; Line 25: by (rewrite ...) [goal&gt; Goal le_pred_lt is proved <span class='goal' style='color: #AA0000'>goal</span> [any] le_pred_lt :<br>  forall (t,t&apos;:timestamp), t &lt;= <span class='gf'>pred</span> t&apos; = t &lt; t&apos;<br>Exiting proof mode.<br><br>Goal le_not_lt :<br>  t &lt;= t&apos; =&gt; <span class='gf'>not</span> (t &lt; t&apos;) =&gt; t = t&apos;<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: t,t&apos;:timestamp[const]<br><span class='sep'>----------------------------------------</span><br>t &lt;= t&apos; =&gt; <span class='gf'>not</span> (t &lt; t&apos;) =&gt; t = t&apos;<br><br>[&gt; Line 31: by (case (= t&apos; init)) [goal&gt; Goal le_not_lt is proved <span class='goal' style='color: #AA0000'>goal</span> [any] le_not_lt :<br>  forall (t,t&apos;:timestamp), t &lt;= t&apos; =&gt; <span class='gf'>not</span> (t &lt; t&apos;) =&gt; t = t&apos;<br>Exiting proof mode.<br><br>Goal le_not_lt_charac :<br>  (<span class='gf'>not</span> (t &lt; t&apos;) &amp;&amp; t &lt;= t&apos;) = (<span class='gm'>happens</span>(t) &amp;&amp; t = t&apos;)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: t,t&apos;:timestamp[const]<br><span class='sep'>----------------------------------------</span><br>(<span class='gf'>not</span> (t &lt; t&apos;) &amp;&amp; t &lt;= t&apos;) = (<span class='gm'>happens</span>(t) &amp;&amp; t = t&apos;)<br><br>[&gt; Line 37: by (rewrite ...) [goal&gt; Goal le_not_lt_charac is proved <span class='goal' style='color: #AA0000'>goal</span> [any] le_not_lt_charac :<br>  forall (t,t&apos;:timestamp), (<span class='gf'>not</span> (t &lt; t&apos;) &amp;&amp; t &lt;= t&apos;) = (<span class='gm'>happens</span>(t) &amp;&amp; t = t&apos;)<br>Exiting proof mode.<br><br>Goal le_lt_ts :<br>  t &lt;&gt; t&apos; =&gt; t &lt;= t&apos; = t &lt; t&apos;<br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: t,t&apos;:timestamp[const]<br><span class='sep'>----------------------------------------</span><br>t &lt;&gt; t&apos; =&gt; t &lt;= t&apos; = t &lt; t&apos;<br><br>[&gt; Line 44: by ((intro *);(rewrite ...)) [goal&gt; Goal le_lt_ts is proved <span class='goal' style='color: #AA0000'>goal</span> [left:default/left, right:default/right] le_lt_ts :<br>  forall (t,t&apos;:timestamp), t &lt;&gt; t&apos; =&gt; t &lt;= t&apos; = t &lt; t&apos;<br>Exiting proof mode.<br><br><span class='goal' style='color: #AA0000'>axiom</span> [any] lt_impl_le [&apos;a] :<br>  forall (x,x&apos;:&apos;a), x &lt; x&apos; =&gt; x &lt;= x&apos;<br><span class='goal' style='color: #AA0000'>axiom</span> [any] le_lt [&apos;a] :<br>  forall (x,x&apos;:&apos;a), x &lt;&gt; x&apos; =&gt; x &lt;= x&apos; = x &lt; x&apos;<br><span class='goal' style='color: #AA0000'>axiom</span> [any] toG_ofG :<br>  forall (x:G), <span class='gf'>toG</span> (<span class='gf'>ofG</span> x) = x<br>Goal ofG_inj :<br>  <span class='gf'>ofG</span> x = <span class='gf'>ofG</span> y =&gt; x = y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:G<br><span class='sep'>----------------------------------------</span><br><span class='gf'>ofG</span> x = <span class='gf'>ofG</span> y =&gt; x = y<br><br>[&gt; Line 61: (intro H) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:G<br>H: <span class='gf'>ofG</span> x = <span class='gf'>ofG</span> y<br><span class='sep'>----------------------------------------</span><br>x = y<br><br>[&gt; Line 62: by ((apply ...  in H);(rewrite ... in H)) [goal&gt; Goal ofG_inj is proved <span class='goal' style='color: #AA0000'>goal</span> [any] ofG_inj :<br>  forall (x,y:G), <span class='gf'>ofG</span> x = <span class='gf'>ofG</span> y =&gt; x = y<br>Exiting proof mode.<br><br>Goal ofG_inj_eq :<br>  (<span class='gf'>ofG</span> x = <span class='gf'>ofG</span> y) = (x = y)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:G<br><span class='sep'>----------------------------------------</span><br>(<span class='gf'>ofG</span> x = <span class='gf'>ofG</span> y) = (x = y)<br><br>[&gt; Line 67: (rewrite ...) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:G<br><span class='sep'>----------------------------------------</span><br><span class='gf'>ofG</span> x = <span class='gf'>ofG</span> y &lt;=&gt; x = y<br><br>[&gt; Line 68: (split; 2: auto) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:G<br><span class='sep'>----------------------------------------</span><br><span class='gf'>ofG</span> x = <span class='gf'>ofG</span> y =&gt; x = y<br><br>[&gt; Line 69: by ((intro _);(apply ... )) [goal&gt; Goal ofG_inj_eq is proved <span class='goal' style='color: #AA0000'>goal</span> [any] ofG_inj_eq :<br>  forall (x,y:G), (<span class='gf'>ofG</span> x = <span class='gf'>ofG</span> y) = (x = y)<br>Exiting proof mode.<br><br><span class='goal' style='color: #AA0000'>axiom</span> [any] exp_mult :<br>  forall (x,y:E), <span class='gf'>gen</span> ^ x ^ y = <span class='gf'>gen</span> ^ (x ** y)<br><span class='goal' style='color: #AA0000'>axiom</span> [any] gen_inj :<br>  forall (x,y:E,z:G), z ^ x = z ^ y =&gt; x = y<br>Goal gen_inj_eq :<br>  (z ^ x = z ^ y) = (x = y)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:E,z:G<br><span class='sep'>----------------------------------------</span><br>(z ^ x = z ^ y) = (x = y)<br><br>[&gt; Line 81: (rewrite ...) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:E,z:G<br><span class='sep'>----------------------------------------</span><br>z ^ x = z ^ y &lt;=&gt; x = y<br><br>[&gt; Line 82: (split; 2: auto) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:E,z:G<br><span class='sep'>----------------------------------------</span><br>z ^ x = z ^ y =&gt; x = y<br><br>[&gt; Line 83: by ((intro _);(apply ... )) [goal&gt; Goal gen_inj_eq is proved <span class='goal' style='color: #AA0000'>goal</span> [any] gen_inj_eq :<br>  forall (x,y:E,z:G), (z ^ x = z ^ y) = (x = y)<br>Exiting proof mode.<br><br><span class='goal' style='color: #AA0000'>axiom</span> [any] dlog_gen :<br>  <span class='gf'>dlog</span> <span class='gf'>gen</span> = <span class='gf'>E_e</span><br><span class='goal' style='color: #AA0000'>axiom</span> [any] dlog_exp :<br>  forall (x:G,y:E), <span class='gf'>dlog</span> (x ^ y) = <span class='gf'>dlog</span> x ** y<br><span class='goal' style='color: #AA0000'>axiom</span> [any] dlog_ax :<br>  forall (x:G), <span class='gf'>gen</span> ^ <span class='gf'>dlog</span> x = x<br><span class='goal' style='color: #AA0000'>axiom</span> [any] inv_E_ax_l :<br>  forall (x:E), <span class='gf'>inv_E</span> x ** x = <span class='gf'>E_e</span><br><span class='goal' style='color: #AA0000'>axiom</span> [any] E_com :<br>  forall (x,y:E), x ** y = y ** x<br><span class='goal' style='color: #AA0000'>axiom</span> [any] E_e_mult_l :<br>  forall (x:E), x ** <span class='gf'>E_e</span> = x<br><span class='goal' style='color: #AA0000'>axiom</span> [any] E_assoc :<br>  forall (x,y,z:E), (x ** y) ** z = x ** y ** z<br>Goal inv_E_ax_r :<br>  x ** <span class='gf'>inv_E</span> x = <span class='gf'>E_e</span><br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x:E<br><span class='sep'>----------------------------------------</span><br>x ** <span class='gf'>inv_E</span> x = <span class='gf'>E_e</span><br><br>[&gt; Line 111: by ((rewrite ...);(apply ... )) [goal&gt; Goal inv_E_ax_r is proved <span class='goal' style='color: #AA0000'>goal</span> [any] inv_E_ax_r :<br>  forall (x:E), x ** <span class='gf'>inv_E</span> x = <span class='gf'>E_e</span><br>Exiting proof mode.<br><br>Goal mult_inv_l :<br>  x ** y = z =&gt; x = z ** <span class='gf'>inv_E</span> y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y,z:E<br><span class='sep'>----------------------------------------</span><br>x ** y = z =&gt; x = z ** <span class='gf'>inv_E</span> y<br><br>[&gt; Line 117: by ((intro H);(rewrite ... ... ... ...)) [goal&gt; Goal mult_inv_l is proved <span class='goal' style='color: #AA0000'>goal</span> [any] mult_inv_l :<br>  forall (x,y,z:E), x ** y = z =&gt; x = z ** <span class='gf'>inv_E</span> y<br>Exiting proof mode.<br><br>Goal E_e_mult_r :<br>  <span class='gf'>E_e</span> ** x = x<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x:E<br><span class='sep'>----------------------------------------</span><br><span class='gf'>E_e</span> ** x = x<br><br>[&gt; Line 122: by (rewrite ... ...) [goal&gt; Goal E_e_mult_r is proved <span class='goal' style='color: #AA0000'>goal</span> [any] E_e_mult_r :<br>  forall (x:E), <span class='gf'>E_e</span> ** x = x<br>Exiting proof mode.<br><br>Goal mult_inj :<br>  a ** x = a ** y =&gt; x = y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,x,y:E<br><span class='sep'>----------------------------------------</span><br>a ** x = a ** y =&gt; x = y<br><br>[&gt; Line 128: (intro H) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,x,y:E<br>H: a ** x = a ** y<br><span class='sep'>----------------------------------------</span><br>x = y<br><br>[&gt; Line 129: (apply ...  in H) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,x,y:E<br>H: <span class='gf'>inv_E</span> a ** a ** x = <span class='gf'>inv_E</span> a ** a ** y<br><span class='sep'>----------------------------------------</span><br>x = y<br><br>[&gt; Line 130: by (rewrite ... ... ... in H) [goal&gt; Goal mult_inj is proved <span class='goal' style='color: #AA0000'>goal</span> [any] mult_inj :<br>  forall (a,x,y:E), a ** x = a ** y =&gt; x = y<br>Exiting proof mode.<br><br>Goal inv_inv :<br>  <span class='gf'>inv_E</span> (<span class='gf'>inv_E</span> x) = x<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x:E<br><span class='sep'>----------------------------------------</span><br><span class='gf'>inv_E</span> (<span class='gf'>inv_E</span> x) = x<br><br>[&gt; Line 135: (apply ... ) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x:E<br><span class='sep'>----------------------------------------</span><br><span class='gf'>inv_E</span> x ** <span class='gf'>inv_E</span> (<span class='gf'>inv_E</span> x) = <span class='gf'>inv_E</span> x ** x<br><br>[&gt; Line 136: by (rewrite ... ...) [goal&gt; Goal inv_inv is proved <span class='goal' style='color: #AA0000'>goal</span> [any] inv_inv :<br>  forall (x:E), <span class='gf'>inv_E</span> (<span class='gf'>inv_E</span> x) = x<br>Exiting proof mode.<br><br><span class='goal' style='color: #AA0000'>axiom</span> [any] neq_option :<br>  forall (x:message), (<span class='gf'>Some</span> x = <span class='gf'>None</span>) = <span class='gf'>false</span><br><span class='goal' style='color: #AA0000'>axiom</span> [any] oget_some :<br>  forall (x:message), <span class='gf'>oget</span> (<span class='gf'>Some</span> x) = x<br>[warning&gt;loaded: Lib.sp<br>&lt;]</span>
</span>

<span class="squirrel-step" id="step32">
<span class="input-line" id="in32"><br><br>(*------------------------------------------------------------------*)<br>(* We prove the secrecy of the key derived by A. *)<br>goal [default] kA_secret (A,B,i:index, t:timestamp):<br>  happens(t) =&gt;<br>  not (happens(corrupt(B))) =&gt;<br>  happens(A2(A,B,i)) =&gt;<br>  cond@A2(A,B,i) =&gt;<br>  input@t = ofG(gkA(A,B,i)@A2(A,B,i)) =&gt;<br>  false.</span>
<span class="output-line" id="out32">Goal kA_secret :<br>  <span class='gm'>happens</span>(t) =&gt;<br>  <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>corrupt(B)</span>) =&gt;<br>  <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>) =&gt;<br>  <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span> =&gt; <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) =&gt; <span class='gf'>false</span><br></span>
</span>

<span class="squirrel-step" id="step33">
<span class="input-line" id="in33"><br>Proof.</span>
<span class="output-line" id="out33">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const],t:timestamp[const]<br><span class='sep'>----------------------------------------</span><br><span class='gm'>happens</span>(t) =&gt;<br><span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>corrupt(B)</span>) =&gt;<br><span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>) =&gt;<br><span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span> =&gt; <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) =&gt; <span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step34">
<span class="input-line" id="in34"><br>  intro Hhap HB Hhap2 Hs He.</span>
<span class="output-line" id="out34">[&gt; Line 116: (intro Hhap HB Hhap2 Hs He) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const],t:timestamp[const]<br>HB: <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>corrupt(B)</span>)<br>He: <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(t)<br>Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Hs: <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step35">
<span class="input-line" id="in35"><br>  euf Hs.</span>
<span class="output-line" id="out35">[&gt; Line 117: (euf Hs) Bad occurrences of k(B) in other actions:<br>  k(A) (collision with k(B)) in action <span class='ga'>corrupt(A)</span> in term <span class='gn'>k</span>(A)<br><br>Total: 1 bad occurrence<br>       0 of them are subsumed by another<br>       1 bad occurrence remaining<br>       [goal&gt; Focused goal (1/3):<br>       System: left:default/left, right:default/right<br>       Variables: A,B,i:index[const],t:timestamp[const]<br>       HB: <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>corrupt(B)</span>)<br>       He: <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>       Hhap: <span class='gm'>happens</span>(t)<br>       Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>       Hs: <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br>       <span class='sep'>----------------------------------------</span><br>       <span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span> =&gt; <span class='gf'>false</span><br>       <br></span>
</span>

<span class="squirrel-step" id="step36">
<span class="input-line" id="in36"><br>  (* case 1: B is corrupted *)<br>  + auto.</span>
<span class="output-line" id="out36">[&gt; Line 119: auto [goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const],t:timestamp[const]<br>HB: <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>corrupt(B)</span>)<br>He: <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(t)<br>Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Hs: <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br>(exists (B0,i0:index),<br>   <span class='ga'>A2(B, B0, i0)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>   &lt;<span class='gf'>tag1</span>,<br>    &lt;<span class='gf'>agent</span> A,&lt;<span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)&gt;&gt;&gt; =<br>   &lt;<span class='gf'>tag2</span>,<br>    &lt;<span class='gf'>agent</span> B0,<br>     &lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(B, B0, i0)@<span class='ga'>A2(B, B0, i0)</span>),<span class='gm'>gy</span>(B, B0, i0)@<span class='ga'>A2(B, B0, i0)</span>&gt;&gt;&gt;) =&gt;<br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step37">
<span class="input-line" id="in37"><br>  (* case 2: the signature came from Alice(B,A,j): impossible thanks to the tags *)<br>   + by intro [_ _ [_ [U _]]]; rewrite tag_neq in U.</span>
<span class="output-line" id="out37">[&gt; Line 121: by ((intro [_ _ [_ [U _]]]);(rewrite ... in U)) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const],t:timestamp[const]<br>HB: <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>corrupt(B)</span>)<br>He: <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(t)<br>Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Hs: <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br>(exists (A0,i0:index),<br>   <span class='ga'>B1(A0, B, i0)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>   &lt;<span class='gf'>tag1</span>,<br>    &lt;<span class='gf'>agent</span> A,&lt;<span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)&gt;&gt;&gt; =<br>   &lt;<span class='gf'>tag1</span>,<br>    &lt;<span class='gf'>agent</span> A0,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A0, B, i0)@<span class='ga'>B1(A0, B, i0)</span>),<span class='gm'>input</span>@<span class='ga'>B1(A0, B, i0)</span>&gt;&gt;&gt;) =&gt;<br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step38">
<span class="input-line" id="in38"><br>  (* case 3: the signature came from Bob *)<br>   + intro [_ j [_ [_ [_ [Hy _]]]]] /=; clear Hs.</span>
<span class="output-line" id="out38">[&gt; Line 123: ((intro [_ j [_ [_ [_ [Hy _]]]]] /=);(clear Hs)) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const],t:timestamp[const]<br>HB: <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>corrupt(B)</span>)<br>He: <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(t)<br>Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Hy: <span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, j)@<span class='ga'>B1(A, B, j)</span>)<br>_: <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) = <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span><br>_: <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step39">
<span class="input-line" id="in39"><br>     rewrite /gy in Hy.</span>
<span class="output-line" id="out39">[&gt; Line 124: (rewrite ... in Hy) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const],t:timestamp[const]<br>HB: <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>corrupt(B)</span>)<br>He: <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(t)<br>Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Hy: <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, j)@<span class='ga'>B1(A, B, j)</span>)<br>_: <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) = <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span><br>_: <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step40">
<span class="input-line" id="in40"><br>     rewrite /gkA Hy /= in He.</span>
<span class="output-line" id="out40">[&gt; Line 125: (rewrite ... ... /= in He) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const],t:timestamp[const]<br>HB: <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>corrupt(B)</span>)<br>He: <span class='gm'>input</span>@t =<br>    <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ (<span class='gm'>yB</span>(A, B, j)@<span class='ga'>B1(A, B, j)</span> ** <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>))<br>Hhap: <span class='gm'>happens</span>(t)<br>Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Hy: <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, j)@<span class='ga'>B1(A, B, j)</span>)<br>_: <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) = <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span><br>_: <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step41">
<span class="input-line" id="in41"><br>     apply f_apply toG in He; simpl.</span>
<span class="output-line" id="out41">[&gt; Line 126: ((apply ...  in He);simpl) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const],t:timestamp[const]<br>HB: <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>corrupt(B)</span>)<br>He: <span class='gf'>toG</span> (<span class='gm'>input</span>@t) =<br>    <span class='gf'>gen</span> ^ (<span class='gm'>yB</span>(A, B, j)@<span class='ga'>B1(A, B, j)</span> ** <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(t)<br>Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Hy: <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, j)@<span class='ga'>B1(A, B, j)</span>)<br>_: <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) = <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span><br>_: <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step42">
<span class="input-line" id="in42"><br><br>     by gdh He, gen.</span>
<span class="output-line" id="out42">[&gt; Line 128: by (gdh He, gen) [goal&gt; Goal kA_secret is proved </span>
</span>

<span class="squirrel-step" id="step43">
<span class="input-line" id="in43"><br>Qed.</span>
<span class="output-line" id="out43"><span class='goal' style='color: #AA0000'>goal</span> [left:default/left, right:default/right] kA_secret :<br>  forall (A,B,i:index,t:timestamp),<br>    <span class='gm'>happens</span>(t) =&gt;<br>    <span class='gf'>not</span> <span class='gm'>happens</span>(<span class='ga'>corrupt(B)</span>) =&gt;<br>    <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>) =&gt;<br>    <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span> =&gt; <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) =&gt; <span class='gf'>false</span><br>Exiting proof mode.<br><br></span>
</span>

<span class="squirrel-step" id="step44">
<span class="input-line" id="in44"><br><br>(*------------------------------------------------------------------*)<br>(* We prove the weak forward secrecy of the key derived by A. *)<br>goal [default] kA_weak_forward_secret (A,B,i:index, t:timestamp):<br>  happens(t) =&gt;<br>  not (corrupt(B) &lt; A2(A,B,i)) =&gt;<br>  happens(A2(A,B,i)) =&gt;<br>  cond@A2(A,B,i) =&gt;<br>  input@t = ofG(gkA(A,B,i)@A2(A,B,i)) =&gt;<br>  false.</span>
<span class="output-line" id="out44">Goal kA_weak_forward_secret :<br>  <span class='gm'>happens</span>(t) =&gt;<br>  <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>) =&gt;<br>  <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>) =&gt;<br>  <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span> =&gt; <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) =&gt; <span class='gf'>false</span><br></span>
</span>

<span class="squirrel-step" id="step45">
<span class="input-line" id="in45"><br>Proof.</span>
<span class="output-line" id="out45">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const],t:timestamp[const]<br><span class='sep'>----------------------------------------</span><br><span class='gm'>happens</span>(t) =&gt;<br><span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>) =&gt;<br><span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>) =&gt;<br><span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span> =&gt; <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) =&gt; <span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step46">
<span class="input-line" id="in46"><br>  intro Hhap HB Hhap2 Hs He.</span>
<span class="output-line" id="out46">[&gt; Line 141: (intro Hhap HB Hhap2 Hs He) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const],t:timestamp[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>He: <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(t)<br>Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Hs: <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step47">
<span class="input-line" id="in47"><br>  euf Hs.</span>
<span class="output-line" id="out47">[&gt; Line 142: (euf Hs) Bad occurrences of k(B) in other actions:<br>  k(A) (collision with k(B)) in action <span class='ga'>corrupt(A)</span> in term <span class='gn'>k</span>(A)<br><br>Total: 1 bad occurrence<br>       0 of them are subsumed by another<br>       1 bad occurrence remaining<br>       [goal&gt; Focused goal (1/3):<br>       System: left:default/left, right:default/right<br>       Variables: A,B,i:index[const],t:timestamp[const]<br>       HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>       He: <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>       Hhap: <span class='gm'>happens</span>(t)<br>       Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>       Hs: <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br>       <span class='sep'>----------------------------------------</span><br>       <span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span> =&gt; <span class='gf'>false</span><br>       <br></span>
</span>

<span class="squirrel-step" id="step48">
<span class="input-line" id="in48"><br>  (* case 1: B is corrupted *)<br>  + auto.</span>
<span class="output-line" id="out48">[&gt; Line 144: auto [goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const],t:timestamp[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>He: <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(t)<br>Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Hs: <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br>(exists (B0,i0:index),<br>   <span class='ga'>A2(B, B0, i0)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>   &lt;<span class='gf'>tag1</span>,<br>    &lt;<span class='gf'>agent</span> A,&lt;<span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)&gt;&gt;&gt; =<br>   &lt;<span class='gf'>tag2</span>,<br>    &lt;<span class='gf'>agent</span> B0,<br>     &lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(B, B0, i0)@<span class='ga'>A2(B, B0, i0)</span>),<span class='gm'>gy</span>(B, B0, i0)@<span class='ga'>A2(B, B0, i0)</span>&gt;&gt;&gt;) =&gt;<br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step49">
<span class="input-line" id="in49"><br>  (* case 2: the signature came from Alice(B,A,j): impossible thanks to the tags *)<br>  + by intro [_ _ [_ [U _]]]; rewrite tag_neq in U.</span>
<span class="output-line" id="out49">[&gt; Line 146: by ((intro [_ _ [_ [U _]]]);(rewrite ... in U)) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const],t:timestamp[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>He: <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(t)<br>Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Hs: <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br>(exists (A0,i0:index),<br>   <span class='ga'>B1(A0, B, i0)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>   &lt;<span class='gf'>tag1</span>,<br>    &lt;<span class='gf'>agent</span> A,&lt;<span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)&gt;&gt;&gt; =<br>   &lt;<span class='gf'>tag1</span>,<br>    &lt;<span class='gf'>agent</span> A0,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A0, B, i0)@<span class='ga'>B1(A0, B, i0)</span>),<span class='gm'>input</span>@<span class='ga'>B1(A0, B, i0)</span>&gt;&gt;&gt;) =&gt;<br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step50">
<span class="input-line" id="in50"><br>  (* case 3: the signature came from Bob *)<br>  + intro [_ j [_ [_ [_ [Hy _]]]]] /=; clear Hs.</span>
<span class="output-line" id="out50">[&gt; Line 148: ((intro [_ j [_ [_ [_ [Hy _]]]]] /=);(clear Hs)) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const],t:timestamp[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>He: <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(t)<br>Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Hy: <span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, j)@<span class='ga'>B1(A, B, j)</span>)<br>_: <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) = <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span><br>_: <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step51">
<span class="input-line" id="in51"><br>    rewrite /gy in Hy.</span>
<span class="output-line" id="out51">[&gt; Line 149: (rewrite ... in Hy) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const],t:timestamp[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>He: <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(t)<br>Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Hy: <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, j)@<span class='ga'>B1(A, B, j)</span>)<br>_: <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) = <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span><br>_: <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step52">
<span class="input-line" id="in52"><br>    rewrite /gkA Hy /= in He.</span>
<span class="output-line" id="out52">[&gt; Line 150: (rewrite ... ... /= in He) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const],t:timestamp[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>He: <span class='gm'>input</span>@t =<br>    <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ (<span class='gm'>yB</span>(A, B, j)@<span class='ga'>B1(A, B, j)</span> ** <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>))<br>Hhap: <span class='gm'>happens</span>(t)<br>Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Hy: <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, j)@<span class='ga'>B1(A, B, j)</span>)<br>_: <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) = <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span><br>_: <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step53">
<span class="input-line" id="in53"><br>    apply f_apply toG in He; simpl.</span>
<span class="output-line" id="out53">[&gt; Line 151: ((apply ...  in He);simpl) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const],t:timestamp[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>He: <span class='gf'>toG</span> (<span class='gm'>input</span>@t) =<br>    <span class='gf'>gen</span> ^ (<span class='gm'>yB</span>(A, B, j)@<span class='ga'>B1(A, B, j)</span> ** <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(t)<br>Hhap2: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Hy: <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, j)@<span class='ga'>B1(A, B, j)</span>)<br>_: <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) = <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span><br>_: <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step54">
<span class="input-line" id="in54"><br>    (* we use the GDH hypothesis *)<br>    by gdh He, gen.</span>
<span class="output-line" id="out54">[&gt; Line 153: by (gdh He, gen) [goal&gt; Goal kA_weak_forward_secret is proved </span>
</span>

<span class="squirrel-step" id="step55">
<span class="input-line" id="in55"><br>Qed.</span>
<span class="output-line" id="out55"><span class='goal' style='color: #AA0000'>goal</span> [left:default/left, right:default/right] kA_weak_forward_secret :<br>  forall (A,B,i:index,t:timestamp),<br>    <span class='gm'>happens</span>(t) =&gt;<br>    <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>) =&gt;<br>    <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>) =&gt;<br>    <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span> =&gt; <span class='gm'>input</span>@t = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) =&gt; <span class='gf'>false</span><br>Exiting proof mode.<br><br></span>
</span>

<span class="squirrel-step" id="step56">
<span class="input-line" id="in56"><br><br>(*------------------------------------------------------------------*)<br>(* Agreement of A holds whenever B has not been corrupted before A&apos;s execution *)<br>goal [default] A_agreement (A,B,i:index):<br>   happens(A2(A,B,i)) =&gt;<br>   not (corrupt(B) &lt; A2(A,B,i)) =&gt;<br>   (cond@A2(A,B,i) &lt;=&gt;<br>    exists (j:index),<br>      B1(A,B,j) &lt; A2(A,B,i) &amp;&amp; <br>      gkA(A,B,i)@A2(A,B,i) = gen^(x(A,B,i) ** y (A,B,j)) &amp;&amp;<br>      fst (input@A2(A,B,i)) = fst (output@B1(A,B,j)) &amp;&amp;<br>      input@B1(A, B, j) = ofG (gen ^ xA(A, B, i)@A2(A, B, i)) &amp;&amp;<br>      checksign(&lt;tag1,&lt;agent A,&lt;ofG (gen ^ y(A, B, j)),ofG (gen ^ x(A, B, i))&gt;&gt;&gt;, <br>                snd (input@A2(A,B,i)), <br>                pk(k(B)))).</span>
<span class="output-line" id="out56">Goal A_agreement :<br>  <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>) =&gt;<br>  <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>) =&gt;<br>  <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span> &lt;=&gt;<br>  exists (j:index),<br>    <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>    <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j)) &amp;&amp;<br>    <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>) &amp;&amp;<br>    <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) &amp;&amp;<br>    <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,<br>                &lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>               <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br></span>
</span>

<span class="squirrel-step" id="step57">
<span class="input-line" id="in57"><br>Proof.</span>
<span class="output-line" id="out57">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const]<br><span class='sep'>----------------------------------------</span><br><span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>) =&gt;<br><span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>) =&gt;<br><span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span> &lt;=&gt;<br>exists (j:index),<br>  <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j)) &amp;&amp;<br>  <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>) &amp;&amp;<br>  <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) &amp;&amp;<br>  <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,&lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>             <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br><br></span>
</span>

<span class="squirrel-step" id="step58">
<span class="input-line" id="in58"><br>  intro Hhap HB.</span>
<span class="output-line" id="out58">[&gt; Line 171: (intro Hhap HB) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br><span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span> &lt;=&gt;<br>exists (j:index),<br>  <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j)) &amp;&amp;<br>  <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>) &amp;&amp;<br>  <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) &amp;&amp;<br>  <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,&lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>             <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br><br></span>
</span>

<span class="squirrel-step" id="step59">
<span class="input-line" id="in59"><br>  split.</span>
<span class="output-line" id="out59">[&gt; Line 172: split [goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br><span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span> =&gt;<br>exists (j:index),<br>  <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j)) &amp;&amp;<br>  <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>) &amp;&amp;<br>  <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) &amp;&amp;<br>  <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,&lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>             <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br><br></span>
</span>

<span class="squirrel-step" id="step60">
<span class="input-line" id="in60"> <br>  - intro Hc.</span>
<span class="output-line" id="out60">[&gt; Line 173: (intro Hc) [goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>Hc: <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br>Hhap: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br>exists (j:index),<br>  <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j)) &amp;&amp;<br>  <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>) &amp;&amp;<br>  <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) &amp;&amp;<br>  <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,&lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>             <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br><br></span>
</span>

<span class="squirrel-step" id="step61">
<span class="input-line" id="in61"><br>    rewrite /cond in Hc.</span>
<span class="output-line" id="out61">[&gt; Line 174: (rewrite ... in Hc) [goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>Hc: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,<br>                &lt;<span class='gf'>agent</span> A,<br>                 &lt;<span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)&gt;&gt;&gt;,<br>               <span class='gm'>sA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>, <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br>exists (j:index),<br>  <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j)) &amp;&amp;<br>  <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>) &amp;&amp;<br>  <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) &amp;&amp;<br>  <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,&lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>             <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br><br></span>
</span>

<span class="squirrel-step" id="step62">
<span class="input-line" id="in62"> <br>    euf Hc.</span>
<span class="output-line" id="out62">[&gt; Line 175: (euf Hc) Bad occurrences of k(B) in other actions:<br>  k(A) (collision with k(B)) in action <span class='ga'>corrupt(A)</span> in term <span class='gn'>k</span>(A)<br><br>Total: 1 bad occurrence<br>       0 of them are subsumed by another<br>       1 bad occurrence remaining<br>       [goal&gt; Focused goal (1/4):<br>       System: left:default/left, right:default/right<br>       Variables: A,B,i:index[const]<br>       HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>       Hc: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,<br>                       &lt;<span class='gf'>agent</span> A,<br>                        &lt;<span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>,<br>                         <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)&gt;&gt;&gt;,<br>                      <span class='gm'>sA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>, <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br>       Hhap: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>       <span class='sep'>----------------------------------------</span><br>       <span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span> =&gt;<br>       exists (j:index),<br>         <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>         <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j)) &amp;&amp;<br>         <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>) &amp;&amp;<br>         <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) &amp;&amp;<br>         <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,<br>                     &lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>                    <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br>       <br></span>
</span>

<span class="squirrel-step" id="step63">
<span class="input-line" id="in63"><br>    + (* case 1: B corrupted *)<br>      auto.</span>
<span class="output-line" id="out63">[&gt; Line 177: auto [goal&gt; Focused goal (1/3):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>Hc: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,<br>                &lt;<span class='gf'>agent</span> A,<br>                 &lt;<span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)&gt;&gt;&gt;,<br>               <span class='gm'>sA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>, <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br>(exists (B0,i0:index),<br>   <span class='ga'>A2(B, B0, i0)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>   &lt;<span class='gf'>tag1</span>,<br>    &lt;<span class='gf'>agent</span> A,&lt;<span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)&gt;&gt;&gt; =<br>   &lt;<span class='gf'>tag2</span>,<br>    &lt;<span class='gf'>agent</span> B0,<br>     &lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(B, B0, i0)@<span class='ga'>A2(B, B0, i0)</span>),<span class='gm'>gy</span>(B, B0, i0)@<span class='ga'>A2(B, B0, i0)</span>&gt;&gt;&gt;) =&gt;<br>exists (j:index),<br>  <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j)) &amp;&amp;<br>  <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>) &amp;&amp;<br>  <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) &amp;&amp;<br>  <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,&lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>             <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br><br></span>
</span>

<span class="squirrel-step" id="step64">
<span class="input-line" id="in64"><br><br>    + (* case 2: signature is from Alice(B,A,j) *)<br>      by intro [_ _ [_ [U _]]]; rewrite tag_neq in U.</span>
<span class="output-line" id="out64">[&gt; Line 180: by ((intro [_ _ [_ [U _]]]);(rewrite ... in U)) [goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>Hc: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,<br>                &lt;<span class='gf'>agent</span> A,<br>                 &lt;<span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)&gt;&gt;&gt;,<br>               <span class='gm'>sA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>, <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br>(exists (A0,i0:index),<br>   <span class='ga'>B1(A0, B, i0)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>   &lt;<span class='gf'>tag1</span>,<br>    &lt;<span class='gf'>agent</span> A,&lt;<span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)&gt;&gt;&gt; =<br>   &lt;<span class='gf'>tag1</span>,<br>    &lt;<span class='gf'>agent</span> A0,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A0, B, i0)@<span class='ga'>B1(A0, B, i0)</span>),<span class='gm'>input</span>@<span class='ga'>B1(A0, B, i0)</span>&gt;&gt;&gt;) =&gt;<br>exists (j:index),<br>  <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j)) &amp;&amp;<br>  <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>) &amp;&amp;<br>  <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) &amp;&amp;<br>  <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,&lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>             <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br><br></span>
</span>

<span class="squirrel-step" id="step65">
<span class="input-line" id="in65"><br><br>    + (* case 3: signature is from Bob(A,B,j) *)<br>      intro [_ j [Ht [_ [_ [H1 H2]]]]].</span>
<span class="output-line" id="out65">[&gt; Line 183: (intro [_ j [Ht [_ [_ [H1 H2]]]]]) [goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: A,A0,B,i,j:index[const]<br>H1: <span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A0, B, j)@<span class='ga'>B1(A0, B, j)</span>)<br>H2: <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) = <span class='gm'>input</span>@<span class='ga'>B1(A0, B, j)</span><br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>Hc: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,<br>                &lt;<span class='gf'>agent</span> A,<br>                 &lt;<span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)&gt;&gt;&gt;,<br>               <span class='gm'>sA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>, <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Ht: <span class='ga'>B1(A0, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br>_: <span class='gf'>agent</span> A = <span class='gf'>agent</span> A0<br><span class='sep'>----------------------------------------</span><br>exists (j:index),<br>  <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j)) &amp;&amp;<br>  <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>) &amp;&amp;<br>  <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) &amp;&amp;<br>  <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,&lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>             <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br><br></span>
</span>

<span class="squirrel-step" id="step66">
<span class="input-line" id="in66"><br>      exists j; simpl.</span>
<span class="output-line" id="out66">[&gt; Line 184: ((exists j);simpl) [goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const]<br>H1: <span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, j)@<span class='ga'>B1(A, B, j)</span>)<br>H2: <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) = <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span><br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>Hc: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,<br>                &lt;<span class='gf'>agent</span> A,<br>                 &lt;<span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)&gt;&gt;&gt;,<br>               <span class='gm'>sA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>, <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br>Ht: <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br><span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j))<br><br></span>
</span>

<span class="squirrel-step" id="step67">
<span class="input-line" id="in67"><br>      by rewrite /gkA H1 /xA /yB E_com.</span>
<span class="output-line" id="out67">[&gt; Line 185: by (rewrite ... ... ... ... ...) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br>(exists (j:index),<br>   <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>   <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j)) &amp;&amp;<br>   <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>) &amp;&amp;<br>   <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) &amp;&amp;<br>   <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,&lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>              <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))) =&gt;<br><span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br><br></span>
</span>

<span class="squirrel-step" id="step68">
<span class="input-line" id="in68"> <br><br>  - intro [j [H1 [H2 H3 H4 H5]]].</span>
<span class="output-line" id="out68">[&gt; Line 187: (intro [j [H1 [H2 H3 H4 H5]]]) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const]<br>H1: <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br>H2: <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j))<br>H3: <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>)<br>H4: <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>H5: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,<br>                &lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>               <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br><span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br><br></span>
</span>

<span class="squirrel-step" id="step69">
<span class="input-line" id="in69"> <br>    rewrite /cond /sA.</span>
<span class="output-line" id="out69">[&gt; Line 188: (rewrite ... ...) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const]<br>H1: <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br>H2: <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j))<br>H3: <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>)<br>H4: <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>H5: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,<br>                &lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>               <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br><span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,<br>            &lt;<span class='gf'>agent</span> A,<br>             &lt;<span class='gm'>gy</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)&gt;&gt;&gt;,<br>           <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br><br></span>
</span>

<span class="squirrel-step" id="step70">
<span class="input-line" id="in70"> <br>    have -&gt;: gy(A, B, i)@A2(A, B, i) = ofG (gen ^ y(A, B, j)) by auto.</span>
<span class="output-line" id="out70">[&gt; Line 189: ((have ...); 1: by auto) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const]<br>H1: <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br>H2: <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j))<br>H3: <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>)<br>H4: <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>H5: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,<br>                &lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>               <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br><span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,<br>            &lt;<span class='gf'>agent</span> A,<br>             &lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)&gt;&gt;&gt;,<br>           <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br><br></span>
</span>

<span class="squirrel-step" id="step71">
<span class="input-line" id="in71"><br>    have -&gt;: ofG (gen ^ xA(A, B, i)@A2(A, B, i)) = ofG (gen ^ x(A, B, i)) by auto.</span>
<span class="output-line" id="out71">[&gt; Line 190: ((have ...); 1: by auto) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const]<br>H1: <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br>H2: <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j))<br>H3: <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>)<br>H4: <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>H5: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,<br>                &lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>               <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br><span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,&lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>           <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br><br></span>
</span>

<span class="squirrel-step" id="step72">
<span class="input-line" id="in72"> <br>    auto.</span>
<span class="output-line" id="out72">[&gt; Line 191: auto [goal&gt; Goal A_agreement is proved </span>
</span>

<span class="squirrel-step" id="step73">
<span class="input-line" id="in73"> <br>Qed.</span>
<span class="output-line" id="out73"><span class='goal' style='color: #AA0000'>goal</span> [left:default/left, right:default/right] A_agreement :<br>  forall (A,B,i:index),<br>    <span class='gm'>happens</span>(<span class='ga'>A2(A, B, i)</span>) =&gt;<br>    <span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>) =&gt;<br>    <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span> &lt;=&gt;<br>    exists (j:index),<br>      <span class='ga'>B1(A, B, j)</span> &lt; <span class='ga'>A2(A, B, i)</span> &amp;&amp;<br>      <span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, i) ** <span class='gn'>y</span>(A, B, j)) &amp;&amp;<br>      <span class='gf'>fst</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>) = <span class='gf'>fst</span> (<span class='gm'>output</span>@<span class='ga'>B1(A, B, j)</span>) &amp;&amp;<br>      <span class='gm'>input</span>@<span class='ga'>B1(A, B, j)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) &amp;&amp;<br>      <span class='gf'>checksign</span> (&lt;<span class='gf'>tag1</span>,<br>                  &lt;<span class='gf'>agent</span> A,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>y</span>(A, B, j)),<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gn'>x</span>(A, B, i))&gt;&gt;&gt;,<br>                 <span class='gf'>snd</span> (<span class='gm'>input</span>@<span class='ga'>A2(A, B, i)</span>), <span class='gf'>pk</span> (<span class='gn'>k</span>(B)))<br>Exiting proof mode.<br><br></span>
</span>

<span class="squirrel-step" id="step74">
<span class="input-line" id="in74"><br><br>(*------------------------------------------------------------------*)<br>(* Agreement of B holds whenever A has not been corrupted before B&apos;s execution *)<br>goal [default] B_agreement (A,B,i:index):<br>   happens(B2(A,B,i)) =&gt;<br>   not (corrupt(A) &lt; B2(A,B,i)) =&gt;<br>   cond@B2(A,B,i) =&gt;<br>   exists (j:index),<br>     A2(A,B,j) &lt; B2(A,B,i) &amp;&amp; gkB(A,B,i)@B2(A,B,i) = gen^(x(A,B,j) ** y (A,B,i)).</span>
<span class="output-line" id="out74">Goal B_agreement :<br>  <span class='gm'>happens</span>(<span class='ga'>B2(A, B, i)</span>) =&gt;<br>  <span class='gf'>not</span> (<span class='ga'>corrupt(A)</span> &lt; <span class='ga'>B2(A, B, i)</span>) =&gt;<br>  <span class='gm'>cond</span>@<span class='ga'>B2(A, B, i)</span> =&gt;<br>  exists (j:index),<br>    <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B2(A, B, i)</span> &amp;&amp;<br>    <span class='gm'>gkB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, j) ** <span class='gn'>y</span>(A, B, i))<br></span>
</span>

<span class="squirrel-step" id="step75">
<span class="input-line" id="in75"><br>Proof.</span>
<span class="output-line" id="out75">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const]<br><span class='sep'>----------------------------------------</span><br><span class='gm'>happens</span>(<span class='ga'>B2(A, B, i)</span>) =&gt;<br><span class='gf'>not</span> (<span class='ga'>corrupt(A)</span> &lt; <span class='ga'>B2(A, B, i)</span>) =&gt;<br><span class='gm'>cond</span>@<span class='ga'>B2(A, B, i)</span> =&gt;<br>exists (j:index),<br>  <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, j) ** <span class='gn'>y</span>(A, B, i))<br><br></span>
</span>

<span class="squirrel-step" id="step76">
<span class="input-line" id="in76"><br>  intro Hhap HB Hc.</span>
<span class="output-line" id="out76">[&gt; Line 203: (intro Hhap HB Hc) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(A)</span> &lt; <span class='ga'>B2(A, B, i)</span>)<br>Hc: <span class='gm'>cond</span>@<span class='ga'>B2(A, B, i)</span><br>Hhap: <span class='gm'>happens</span>(<span class='ga'>B2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br>exists (j:index),<br>  <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, j) ** <span class='gn'>y</span>(A, B, i))<br><br></span>
</span>

<span class="squirrel-step" id="step77">
<span class="input-line" id="in77"><br>  rewrite /cond in Hc.</span>
<span class="output-line" id="out77">[&gt; Line 204: (rewrite ... in Hc) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const]<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(A)</span> &lt; <span class='ga'>B2(A, B, i)</span>)<br>Hc: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag2</span>,<br>                &lt;<span class='gf'>agent</span> B,<br>                 &lt;<span class='gm'>input</span>@<span class='ga'>B1(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span>)&gt;&gt;&gt;,<br>               <span class='gm'>input</span>@<span class='ga'>B2(A, B, i)</span>, <span class='gf'>pk</span> (<span class='gn'>k</span>(A)))<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>B2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br>exists (j:index),<br>  <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, j) ** <span class='gn'>y</span>(A, B, i))<br><br></span>
</span>

<span class="squirrel-step" id="step78">
<span class="input-line" id="in78"><br>  have C := depends_default_B1_B2 _ A B i _ Hhap =&gt; //.</span>
<span class="output-line" id="out78">[&gt; Line 205: ((have (C := ...));(intro //)) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const]<br>C: <span class='ga'>B1(A, B, i)</span> &lt; <span class='ga'>B2(A, B, i)</span><br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(A)</span> &lt; <span class='ga'>B2(A, B, i)</span>)<br>Hc: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag2</span>,<br>                &lt;<span class='gf'>agent</span> B,<br>                 &lt;<span class='gm'>input</span>@<span class='ga'>B1(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span>)&gt;&gt;&gt;,<br>               <span class='gm'>input</span>@<span class='ga'>B2(A, B, i)</span>, <span class='gf'>pk</span> (<span class='gn'>k</span>(A)))<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>B2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br>exists (j:index),<br>  <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, j) ** <span class='gn'>y</span>(A, B, i))<br><br></span>
</span>

<span class="squirrel-step" id="step79">
<span class="input-line" id="in79"> <br>  euf Hc.</span>
<span class="output-line" id="out79">[&gt; Line 206: (euf Hc) Bad occurrences of k(A) in other actions:<br>  k(A) (collision with k(A)) in action <span class='ga'>corrupt(A)</span> in term <span class='gn'>k</span>(A)<br><br>Total: 1 bad occurrence<br>       0 of them are subsumed by another<br>       1 bad occurrence remaining<br>       [goal&gt; Focused goal (1/3):<br>       System: left:default/left, right:default/right<br>       Variables: A,B,i:index[const]<br>       C: <span class='ga'>B1(A, B, i)</span> &lt; <span class='ga'>B2(A, B, i)</span><br>       HB: <span class='gf'>not</span> (<span class='ga'>corrupt(A)</span> &lt; <span class='ga'>B2(A, B, i)</span>)<br>       Hc: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag2</span>,<br>                       &lt;<span class='gf'>agent</span> B,<br>                        &lt;<span class='gm'>input</span>@<span class='ga'>B1(A, B, i)</span>,<br>                         <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span>)&gt;&gt;&gt;,<br>                      <span class='gm'>input</span>@<span class='ga'>B2(A, B, i)</span>, <span class='gf'>pk</span> (<span class='gn'>k</span>(A)))<br>       Hhap: <span class='gm'>happens</span>(<span class='ga'>B2(A, B, i)</span>)<br>       <span class='sep'>----------------------------------------</span><br>       <span class='ga'>corrupt(A)</span> &lt; <span class='ga'>B1(A, B, i)</span> || <span class='ga'>corrupt(A)</span> &lt; <span class='ga'>B2(A, B, i)</span> =&gt;<br>       exists (j:index),<br>         <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B2(A, B, i)</span> &amp;&amp;<br>         <span class='gm'>gkB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, j) ** <span class='gn'>y</span>(A, B, i))<br>       <br></span>
</span>

<span class="squirrel-step" id="step80">
<span class="input-line" id="in80"><br>    + (* case 1: B corrupted *)<br>      by intro [].</span>
<span class="output-line" id="out80">[&gt; Line 208: by (intro []) [goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const]<br>C: <span class='ga'>B1(A, B, i)</span> &lt; <span class='ga'>B2(A, B, i)</span><br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(A)</span> &lt; <span class='ga'>B2(A, B, i)</span>)<br>Hc: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag2</span>,<br>                &lt;<span class='gf'>agent</span> B,<br>                 &lt;<span class='gm'>input</span>@<span class='ga'>B1(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span>)&gt;&gt;&gt;,<br>               <span class='gm'>input</span>@<span class='ga'>B2(A, B, i)</span>, <span class='gf'>pk</span> (<span class='gn'>k</span>(A)))<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>B2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br>(exists (B0,i0:index),<br>   (<span class='ga'>A2(A, B0, i0)</span> &lt; <span class='ga'>B1(A, B, i)</span> || <span class='ga'>A2(A, B0, i0)</span> &lt; <span class='ga'>B2(A, B, i)</span>) &amp;&amp;<br>   &lt;<span class='gf'>tag2</span>,&lt;<span class='gf'>agent</span> B,&lt;<span class='gm'>input</span>@<span class='ga'>B1(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span>)&gt;&gt;&gt; =<br>   &lt;<span class='gf'>tag2</span>,<br>    &lt;<span class='gf'>agent</span> B0,<br>     &lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B0, i0)@<span class='ga'>A2(A, B0, i0)</span>),<span class='gm'>gy</span>(A, B0, i0)@<span class='ga'>A2(A, B0, i0)</span>&gt;&gt;&gt;) =&gt;<br>exists (j:index),<br>  <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, j) ** <span class='gn'>y</span>(A, B, i))<br><br></span>
</span>

<span class="squirrel-step" id="step81">
<span class="input-line" id="in81"> <br>    + (* case 2: signature is from Alice(B,A,j) *)<br>      intro [_ j [C0 [_ [_ [H _]]]]] //=; clear Hc.</span>
<span class="output-line" id="out81">[&gt; Line 210: ((intro [_ j [C0 [_ [_ [H _]]]]] //=);(clear Hc)) [goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const]<br>C: <span class='ga'>B1(A, B, i)</span> &lt; <span class='ga'>B2(A, B, i)</span><br>C0: <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B1(A, B, i)</span> || <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B2(A, B, i)</span><br>H: <span class='gm'>input</span>@<span class='ga'>B1(A, B, i)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, j)@<span class='ga'>A2(A, B, j)</span>)<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(A)</span> &lt; <span class='ga'>B2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>B2(A, B, i)</span>)<br>_: <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span>) = <span class='gm'>gy</span>(A, B, j)@<span class='ga'>A2(A, B, j)</span><br><span class='sep'>----------------------------------------</span><br>exists (j:index),<br>  <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, j) ** <span class='gn'>y</span>(A, B, i))<br><br></span>
</span>

<span class="squirrel-step" id="step82">
<span class="input-line" id="in82"><br>      exists j =&gt; /=.</span>
<span class="output-line" id="out82">[&gt; Line 211: ((exists j);(intro /=)) [goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const]<br>C: <span class='ga'>B1(A, B, i)</span> &lt; <span class='ga'>B2(A, B, i)</span><br>C0: <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B1(A, B, i)</span> || <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B2(A, B, i)</span><br>H: <span class='gm'>input</span>@<span class='ga'>B1(A, B, i)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, j)@<span class='ga'>A2(A, B, j)</span>)<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(A)</span> &lt; <span class='ga'>B2(A, B, i)</span>)<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>B2(A, B, i)</span>)<br>_: <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span>) = <span class='gm'>gy</span>(A, B, j)@<span class='ga'>A2(A, B, j)</span><br><span class='sep'>----------------------------------------</span><br><span class='gm'>gkB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, j) ** <span class='gn'>y</span>(A, B, i))<br><br></span>
</span>

<span class="squirrel-step" id="step83">
<span class="input-line" id="in83"><br>      have ?: happens(A2(A,B,j)) by case C0.</span>
<span class="output-line" id="out83">[&gt; Line 212: ((have ...); 1: by (case C0)) [goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: A,B,i,j:index[const]<br>C: <span class='ga'>B1(A, B, i)</span> &lt; <span class='ga'>B2(A, B, i)</span><br>C0: <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B1(A, B, i)</span> || <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B2(A, B, i)</span><br>H: <span class='gm'>input</span>@<span class='ga'>B1(A, B, i)</span> = <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>xA</span>(A, B, j)@<span class='ga'>A2(A, B, j)</span>)<br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(A)</span> &lt; <span class='ga'>B2(A, B, i)</span>)<br>Hap: <span class='gm'>happens</span>(<span class='ga'>A2(A, B, j)</span>)<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>B2(A, B, i)</span>)<br>_: <span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span>) = <span class='gm'>gy</span>(A, B, j)@<span class='ga'>A2(A, B, j)</span><br><span class='sep'>----------------------------------------</span><br><span class='gm'>gkB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, j) ** <span class='gn'>y</span>(A, B, i))<br><br></span>
</span>

<span class="squirrel-step" id="step84">
<span class="input-line" id="in84"> <br>      by rewrite /gkB H.</span>
<span class="output-line" id="out84">[&gt; Line 213: by (rewrite ... ...) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,B,i:index[const]<br>C: <span class='ga'>B1(A, B, i)</span> &lt; <span class='ga'>B2(A, B, i)</span><br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(A)</span> &lt; <span class='ga'>B2(A, B, i)</span>)<br>Hc: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag2</span>,<br>                &lt;<span class='gf'>agent</span> B,<br>                 &lt;<span class='gm'>input</span>@<span class='ga'>B1(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span>)&gt;&gt;&gt;,<br>               <span class='gm'>input</span>@<span class='ga'>B2(A, B, i)</span>, <span class='gf'>pk</span> (<span class='gn'>k</span>(A)))<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>B2(A, B, i)</span>)<br><span class='sep'>----------------------------------------</span><br>(exists (A0,i0:index),<br>   (<span class='ga'>B1(A0, A, i0)</span> &lt; <span class='ga'>B1(A, B, i)</span> || <span class='ga'>B1(A0, A, i0)</span> &lt; <span class='ga'>B2(A, B, i)</span>) &amp;&amp;<br>   &lt;<span class='gf'>tag2</span>,&lt;<span class='gf'>agent</span> B,&lt;<span class='gm'>input</span>@<span class='ga'>B1(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span>)&gt;&gt;&gt; =<br>   &lt;<span class='gf'>tag1</span>,<br>    &lt;<span class='gf'>agent</span> A0,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A0, A, i0)@<span class='ga'>B1(A0, A, i0)</span>),<span class='gm'>input</span>@<span class='ga'>B1(A0, A, i0)</span>&gt;&gt;&gt;) =&gt;<br>exists (j:index),<br>  <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, j) ** <span class='gn'>y</span>(A, B, i))<br><br></span>
</span>

<span class="squirrel-step" id="step85">
<span class="input-line" id="in85"> <br>    + (* case 3: signature is from Bob(A,B,j) *)<br>      intro [_ _ [_ [U _]]].</span>
<span class="output-line" id="out85">[&gt; Line 215: (intro [_ _ [_ [U _]]]) [goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: A,A0,B,i,i0:index[const]<br>C: <span class='ga'>B1(A, B, i)</span> &lt; <span class='ga'>B2(A, B, i)</span><br>HB: <span class='gf'>not</span> (<span class='ga'>corrupt(A)</span> &lt; <span class='ga'>B2(A, B, i)</span>)<br>Hc: <span class='gf'>checksign</span> (&lt;<span class='gf'>tag2</span>,<br>                &lt;<span class='gf'>agent</span> B,<br>                 &lt;<span class='gm'>input</span>@<span class='ga'>B1(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span>)&gt;&gt;&gt;,<br>               <span class='gm'>input</span>@<span class='ga'>B2(A, B, i)</span>, <span class='gf'>pk</span> (<span class='gn'>k</span>(A)))<br>Hhap: <span class='gm'>happens</span>(<span class='ga'>B2(A, B, i)</span>)<br>U: <span class='gf'>tag2</span> = <span class='gf'>tag1</span><br>_: &lt;<span class='gf'>agent</span> B,&lt;<span class='gm'>input</span>@<span class='ga'>B1(A, B, i)</span>,<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span>)&gt;&gt; =<br>   &lt;<span class='gf'>agent</span> A0,&lt;<span class='gf'>ofG</span> (<span class='gf'>gen</span> ^ <span class='gm'>yB</span>(A0, A, i0)@<span class='ga'>B1(A0, A, i0)</span>),<span class='gm'>input</span>@<span class='ga'>B1(A0, A, i0)</span>&gt;&gt;<br>_: <span class='ga'>B1(A0, A, i0)</span> &lt; <span class='ga'>B1(A, B, i)</span> || <span class='ga'>B1(A0, A, i0)</span> &lt; <span class='ga'>B2(A, B, i)</span><br><span class='sep'>----------------------------------------</span><br>exists (j:index),<br>  <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B2(A, B, i)</span> &amp;&amp;<br>  <span class='gm'>gkB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, j) ** <span class='gn'>y</span>(A, B, i))<br><br></span>
</span>

<span class="squirrel-step" id="step86">
<span class="input-line" id="in86"> <br>      by rewrite eq_sym tag_neq in U.</span>
<span class="output-line" id="out86">[&gt; Line 216: by (rewrite ... ... in U) [goal&gt; Goal B_agreement is proved </span>
</span>

<span class="squirrel-step" id="step87">
<span class="input-line" id="in87"> <br>Qed.</span>
<span class="output-line" id="out87"><span class='goal' style='color: #AA0000'>goal</span> [left:default/left, right:default/right] B_agreement :<br>  forall (A,B,i:index),<br>    <span class='gm'>happens</span>(<span class='ga'>B2(A, B, i)</span>) =&gt;<br>    <span class='gf'>not</span> (<span class='ga'>corrupt(A)</span> &lt; <span class='ga'>B2(A, B, i)</span>) =&gt;<br>    <span class='gm'>cond</span>@<span class='ga'>B2(A, B, i)</span> =&gt;<br>    exists (j:index),<br>      <span class='ga'>A2(A, B, j)</span> &lt; <span class='ga'>B2(A, B, i)</span> &amp;&amp;<br>      <span class='gm'>gkB</span>(A, B, i)@<span class='ga'>B2(A, B, i)</span> = <span class='gf'>gen</span> ^ (<span class='gn'>x</span>(A, B, j) ** <span class='gn'>y</span>(A, B, i))<br>Exiting proof mode.<br><br></span>
</span>

<span class="squirrel-step" id="step88">
<span class="input-line" id="in88"><br><br>goal [any] aux (t, t&apos; : timestamp) : (t &lt;= pred t&apos; &amp;&amp; t &lt;= t&apos;) &lt;=&gt; t &lt;= pred t&apos;.</span>
<span class="output-line" id="out88">Goal aux :<br>  t &lt;= <span class='gf'>pred</span> t&apos; &amp;&amp; t &lt;= t&apos; &lt;=&gt; t &lt;= <span class='gf'>pred</span> t&apos;<br></span>
</span>

<span class="squirrel-step" id="step89">
<span class="input-line" id="in89"><br>Proof.</span>
<span class="output-line" id="out89">[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: t,t&apos;:timestamp[const]<br><span class='sep'>----------------------------------------</span><br>t &lt;= <span class='gf'>pred</span> t&apos; &amp;&amp; t &lt;= t&apos; &lt;=&gt; t &lt;= <span class='gf'>pred</span> t&apos;<br><br></span>
</span>

<span class="squirrel-step" id="step90">
<span class="input-line" id="in90"> auto.</span>
<span class="output-line" id="out90">[&gt; Line 220: auto [goal&gt; Goal aux is proved </span>
</span>

<span class="squirrel-step" id="step91">
<span class="input-line" id="in91"> Qed.</span>
<span class="output-line" id="out91"><span class='goal' style='color: #AA0000'>goal</span> [any] aux :<br>  forall (t,t&apos;:timestamp), t &lt;= <span class='gf'>pred</span> t&apos; &amp;&amp; t &lt;= t&apos; &lt;=&gt; t &lt;= <span class='gf'>pred</span> t&apos;<br>Exiting proof mode.<br><br></span>
</span>

<span class="squirrel-step" id="step92">
<span class="input-line" id="in92"><br><br>(*------------------------------------------------------------------*)<br>(* Assumptions *)<br><br>(* Strong assumption, which could be weakened to a more realistic one <br>   by adding a condition &quot;only when checkG(x)&quot; *)<br>axiom [any] ofG_toG (x:message) : ofG(toG(x)) = x.</span>
<span class="output-line" id="out92"><span class='goal' style='color: #AA0000'>axiom</span> [any] ofG_toG :<br>  forall (x:message), <span class='gf'>ofG</span> (<span class='gf'>toG</span> x) = x<br></span>
</span>

<span class="squirrel-step" id="step93">
<span class="input-line" id="in93"><br><br>(* =&gt; is from toG_ofG, &lt;= from ofG_toG *)<br>goal [any] ofG_swap (x:message, y:G) : (x = ofG(y)) = (toG(x) = y).</span>
<span class="output-line" id="out93">Goal ofG_swap :<br>  (x = <span class='gf'>ofG</span> y) = (<span class='gf'>toG</span> x = y)<br></span>
</span>

<span class="squirrel-step" id="step94">
<span class="input-line" id="in94"><br>Proof.</span>
<span class="output-line" id="out94">[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x:message,y:G<br><span class='sep'>----------------------------------------</span><br>(x = <span class='gf'>ofG</span> y) = (<span class='gf'>toG</span> x = y)<br><br></span>
</span>

<span class="squirrel-step" id="step95">
<span class="input-line" id="in95"><br> rewrite eq_iff; split.</span>
<span class="output-line" id="out95">[&gt; Line 232: ((rewrite ...);split) [goal&gt; Focused goal (1/2):<br>System: any<br>Variables: x:message,y:G<br><span class='sep'>----------------------------------------</span><br>x = <span class='gf'>ofG</span> y =&gt; <span class='gf'>toG</span> x = y<br><br></span>
</span>

<span class="squirrel-step" id="step96">
<span class="input-line" id="in96"><br> by rewrite (f_apply toG x (ofG(y))).</span>
<span class="output-line" id="out96">[&gt; Line 233: by (rewrite ...) [goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x:message,y:G<br><span class='sep'>----------------------------------------</span><br><span class='gf'>toG</span> x = y =&gt; x = <span class='gf'>ofG</span> y<br><br></span>
</span>

<span class="squirrel-step" id="step97">
<span class="input-line" id="in97"> <br> by rewrite -(ofG_toG x).</span>
<span class="output-line" id="out97">[&gt; Line 234: by (rewrite ...) [goal&gt; Goal ofG_swap is proved </span>
</span>

<span class="squirrel-step" id="step98">
<span class="input-line" id="in98"><br>Qed.</span>
<span class="output-line" id="out98"><span class='goal' style='color: #AA0000'>goal</span> [any] ofG_swap :<br>  forall (x:message,y:G), (x = <span class='gf'>ofG</span> y) = (<span class='gf'>toG</span> x = y)<br>Exiting proof mode.<br><br></span>
</span>

<span class="squirrel-step" id="step99">
<span class="input-line" id="in99"><br><br>(*------------------------------------------------------------------*)<br>name nfresh : message.</span>
<span class="output-line" id="out99"></span>
</span>

<span class="squirrel-step" id="step100">
<span class="input-line" id="in100"><br><br>(* Strong forward secrecy of A&apos;s key as long. *)<br>global goal [set:default/left; equiv:default/left, default/left]<br>  kA_strong_forward_secrecy (t, t0 : timestamp[const], A,B,i:index[const]) :<br>  [t = A2(A,B,i)] -&gt;<br>  [t &lt;= t0] -&gt;<br>  [not (corrupt B &lt; t)] -&gt;<br>  equiv(<br>    frame@t0, <br>    if cond@t then diff(kA(A,B,i)@t, nfresh)).</span>
<span class="output-line" id="out100">Goal kA_strong_forward_secrecy :<br>  forall A,B,i:index[const, glob],t,t0:timestamp[const, glob],<br>  [t = <span class='ga'>A2(A, B, i)</span>] -&gt;<br>  [t &lt;= t0] -&gt;<br>  [<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; t)] -&gt;<br>  equiv(<span class='gm'>frame</span>@t0, if <span class='gm'>cond</span>@t then diff(<span class='gm'>kA</span>(A, B, i)@t, <span class='gn'>nfresh</span>))<br></span>
</span>

<span class="squirrel-step" id="step101">
<span class="input-line" id="in101"><br>Proof.</span>
<span class="output-line" id="out101">[goal&gt; Focused goal (1/1):<br>Systems: default/left (equivalences: left:default/left, right:default/left)<br>Variables: A,B,i:index[const, glob],t,t0:timestamp[const, glob]<br><span class='sep'>----------------------------------------</span><br>[t = <span class='ga'>A2(A, B, i)</span>] -&gt;<br>[t &lt;= t0] -&gt;<br>[<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; t)] -&gt;<br>equiv(<span class='gm'>frame</span>@t0, if <span class='gm'>cond</span>@t then diff(<span class='gm'>kA</span>(A, B, i)@t, <span class='gn'>nfresh</span>))<br><br></span>
</span>

<span class="squirrel-step" id="step102">
<span class="input-line" id="in102"><br>  intro Heq Hhap Hcorrupt.</span>
<span class="output-line" id="out102">[&gt; Line 250: (intro Heq Hhap Hcorrupt) [goal&gt; Focused goal (1/1):<br>Systems: default/left (equivalences: left:default/left, right:default/left)<br>Variables: A,B,i:index[const, glob],t,t0:timestamp[const, glob]<br>Hcorrupt: [<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; t)]<br>Heq: [t = <span class='ga'>A2(A, B, i)</span>]<br>Hhap: [t &lt;= t0]<br><span class='sep'>----------------------------------------</span><br>0: <span class='gm'>frame</span>@t0<br>1: if <span class='gm'>cond</span>@t then diff(<span class='gm'>kA</span>(A, B, i)@t, <span class='gn'>nfresh</span>)<br><br><br></span>
</span>

<span class="squirrel-step" id="step103">
<span class="input-line" id="in103"> <br>  rewrite /kA.</span>
<span class="output-line" id="out103">[&gt; Line 251: (rewrite ...) [goal&gt; Focused goal (1/1):<br>Systems: default/left (equivalences: left:default/left, right:default/left)<br>Variables: A,B,i:index[const, glob],t,t0:timestamp[const, glob]<br>Hcorrupt: [<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; t)]<br>Heq: [t = <span class='ga'>A2(A, B, i)</span>]<br>Hhap: [t &lt;= t0]<br><span class='sep'>----------------------------------------</span><br>0: <span class='gm'>frame</span>@t0<br>1: if <span class='gm'>cond</span>@t then diff(<span class='gf'>KDF</span> (<span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@t), <span class='gn'>kKDF</span>), <span class='gn'>nfresh</span>)<br><br><br></span>
</span>

<span class="squirrel-step" id="step104">
<span class="input-line" id="in104"> <br>  prf 1 =&gt; /=.</span>
<span class="output-line" id="out104">[&gt; Line 252: ((prf 1);(intro /=)) [goal&gt; Focused goal (1/1):<br>Systems: default/left (equivalences: left:default/left, right:default/left)<br>Variables: A,B,i:index[const, glob],t,t0:timestamp[const, glob]<br>Hcorrupt: [<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; t)]<br>Heq: [t = <span class='ga'>A2(A, B, i)</span>]<br>Hhap: [t &lt;= t0]<br><span class='sep'>----------------------------------------</span><br>0: <span class='gm'>frame</span>@t0<br>1: if <span class='gm'>cond</span>@t then<br>     diff(<br>       if (forall (O:index),<br>             <span class='ga'>O(O)</span> &lt;= t0 || <span class='ga'>O(O)</span> &lt; t =&gt; <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@t) &lt;&gt; <span class='gm'>input</span>@<span class='ga'>O(O)</span>)<br>         then <span class='gn'>n_PRF</span><br>       else <span class='gf'>KDF</span> (<span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@t), <span class='gn'>kKDF</span>), <span class='gn'>nfresh</span>)<br><br><br></span>
</span>

<span class="squirrel-step" id="step105">
<span class="input-line" id="in105"> <br>  rewrite (if_true _ n_PRF).</span>
<span class="output-line" id="out105">[&gt; Line 253: (rewrite ...) [goal&gt; Focused goal (1/2):<br>System: left:default/left<br>        (equivalences: left:default/left, right:default/left)<br>Variables: A,B,i:index[const, glob],t,t0:timestamp[const, glob]<br>Hcorrupt: [<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; t)]<br>Heq: [t = <span class='ga'>A2(A, B, i)</span>]<br>Hhap: [t &lt;= t0]<br><span class='sep'>----------------------------------------</span><br><span class='gm'>cond</span>@t =&gt;<br>forall (O:index),<br>  <span class='ga'>O(O)</span> &lt;= t0 || <span class='ga'>O(O)</span> &lt; t =&gt; <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@t) &lt;&gt; <span class='gm'>input</span>@<span class='ga'>O(O)</span><br><br></span>
</span>

<span class="squirrel-step" id="step106">
<span class="input-line" id="in106"> {<br>    intro Cond.</span>
<span class="output-line" id="out106">[&gt; Line 254: (intro Cond) [goal&gt; Focused goal (1/2):<br>System: left:default/left<br>        (equivalences: left:default/left, right:default/left)<br>Variables: A,B,i:index[const, glob],t,t0:timestamp[const, glob]<br>Cond: <span class='gm'>cond</span>@t<br>Hcorrupt: [<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; t)]<br>Heq: [t = <span class='ga'>A2(A, B, i)</span>]<br>Hhap: [t &lt;= t0]<br><span class='sep'>----------------------------------------</span><br>forall (O:index),<br>  <span class='ga'>O(O)</span> &lt;= t0 || <span class='ga'>O(O)</span> &lt; t =&gt; <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@t) &lt;&gt; <span class='gm'>input</span>@<span class='ga'>O(O)</span><br><br></span>
</span>

<span class="squirrel-step" id="step107">
<span class="input-line" id="in107"><br>    rewrite Heq in *.</span>
<span class="output-line" id="out107">[&gt; Line 255: (rewrite ... in *) [goal&gt; Focused goal (1/2):<br>System: left:default/left<br>        (equivalences: left:default/left, right:default/left)<br>Variables: A,B,i:index[const, glob],t,t0:timestamp[const, glob]<br>Cond: <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br>Hcorrupt: [<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)]<br>Heq: [t = <span class='ga'>A2(A, B, i)</span>]<br>Hhap: [<span class='ga'>A2(A, B, i)</span> &lt;= t0]<br><span class='sep'>----------------------------------------</span><br>forall (O:index),<br>  <span class='ga'>O(O)</span> &lt;= t0 || <span class='ga'>O(O)</span> &lt; <span class='ga'>A2(A, B, i)</span> =&gt;<br>  <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) &lt;&gt; <span class='gm'>input</span>@<span class='ga'>O(O)</span><br><br></span>
</span>

<span class="squirrel-step" id="step108">
<span class="input-line" id="in108"><br>    intro j H1 H2.</span>
<span class="output-line" id="out108">[&gt; Line 256: (intro j H1 H2) [goal&gt; Focused goal (1/2):<br>System: left:default/left<br>        (equivalences: left:default/left, right:default/left)<br>Variables: A,B,i:index[const, glob],j:index[const],<br>t,t0:timestamp[const, glob]<br>Cond: <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br>H1: <span class='ga'>O(j)</span> &lt;= t0 || <span class='ga'>O(j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br>H2: <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) = <span class='gm'>input</span>@<span class='ga'>O(j)</span><br>Hcorrupt: [<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)]<br>Heq: [t = <span class='ga'>A2(A, B, i)</span>]<br>Hhap: [<span class='ga'>A2(A, B, i)</span> &lt;= t0]<br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step109">
<span class="input-line" id="in109"><br>    have ? : O(j) &lt;= t0 by case H1.</span>
<span class="output-line" id="out109">[&gt; Line 257: ((have ...); 1: by (case H1)) [goal&gt; Focused goal (1/2):<br>System: left:default/left<br>        (equivalences: left:default/left, right:default/left)<br>Variables: A,B,i:index[const, glob],j:index[const],<br>t,t0:timestamp[const, glob]<br>Cle: <span class='ga'>O(j)</span> &lt;= t0<br>Cond: <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br>H1: <span class='ga'>O(j)</span> &lt;= t0 || <span class='ga'>O(j)</span> &lt; <span class='ga'>A2(A, B, i)</span><br>H2: <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) = <span class='gm'>input</span>@<span class='ga'>O(j)</span><br>Hcorrupt: [<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)]<br>Heq: [t = <span class='ga'>A2(A, B, i)</span>]<br>Hhap: [<span class='ga'>A2(A, B, i)</span> &lt;= t0]<br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step110">
<span class="input-line" id="in110"> <br>    clear H1.</span>
<span class="output-line" id="out110">[&gt; Line 258: (clear H1) [goal&gt; Focused goal (1/2):<br>System: left:default/left<br>        (equivalences: left:default/left, right:default/left)<br>Variables: A,B,i:index[const, glob],j:index[const],<br>t,t0:timestamp[const, glob]<br>Cle: <span class='ga'>O(j)</span> &lt;= t0<br>Cond: <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br>H2: <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>) = <span class='gm'>input</span>@<span class='ga'>O(j)</span><br>Hcorrupt: [<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)]<br>Heq: [t = <span class='ga'>A2(A, B, i)</span>]<br>Hhap: [<span class='ga'>A2(A, B, i)</span> &lt;= t0]<br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step111">
<span class="input-line" id="in111"><br>    rewrite eq_sym in H2.</span>
<span class="output-line" id="out111">[&gt; Line 259: (rewrite ... in H2) [goal&gt; Focused goal (1/2):<br>System: left:default/left<br>        (equivalences: left:default/left, right:default/left)<br>Variables: A,B,i:index[const, glob],j:index[const],<br>t,t0:timestamp[const, glob]<br>Cle: <span class='ga'>O(j)</span> &lt;= t0<br>Cond: <span class='gm'>cond</span>@<span class='ga'>A2(A, B, i)</span><br>H2: <span class='gm'>input</span>@<span class='ga'>O(j)</span> = <span class='gf'>ofG</span> (<span class='gm'>gkA</span>(A, B, i)@<span class='ga'>A2(A, B, i)</span>)<br>Hcorrupt: [<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; <span class='ga'>A2(A, B, i)</span>)]<br>Heq: [t = <span class='ga'>A2(A, B, i)</span>]<br>Hhap: [<span class='ga'>A2(A, B, i)</span> &lt;= t0]<br><span class='sep'>----------------------------------------</span><br><span class='gf'>false</span><br><br></span>
</span>

<span class="squirrel-step" id="step112">
<span class="input-line" id="in112"> <br>    by apply kA_weak_forward_secret in H2.</span>
<span class="output-line" id="out112">[&gt; Line 260: by (apply ...  in H2) [goal&gt; Focused goal (1/1):<br>Systems: default/left (equivalences: left:default/left, right:default/left)<br>Variables: A,B,i:index[const, glob],t,t0:timestamp[const, glob]<br>Hcorrupt: [<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; t)]<br>Heq: [t = <span class='ga'>A2(A, B, i)</span>]<br>Hhap: [t &lt;= t0]<br><span class='sep'>----------------------------------------</span><br>0: <span class='gm'>frame</span>@t0<br>1: if <span class='gm'>cond</span>@t then diff(<span class='gn'>n_PRF</span>, <span class='gn'>nfresh</span>)<br><br><br></span>
</span>

<span class="squirrel-step" id="step113">
<span class="input-line" id="in113"><br>  }.</span>
<span class="output-line" id="out113">[&gt; Line 261: ?? [goal&gt; Focused goal (1/1):<br>Systems: default/left (equivalences: left:default/left, right:default/left)<br>Variables: A,B,i:index[const, glob],t,t0:timestamp[const, glob]<br>Hcorrupt: [<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; t)]<br>Heq: [t = <span class='ga'>A2(A, B, i)</span>]<br>Hhap: [t &lt;= t0]<br><span class='sep'>----------------------------------------</span><br>0: <span class='gm'>frame</span>@t0<br>1: if <span class='gm'>cond</span>@t then diff(<span class='gn'>n_PRF</span>, <span class='gn'>nfresh</span>)<br><br><br></span>
</span>

<span class="squirrel-step" id="step114">
<span class="input-line" id="in114"><br>  fa 1.</span>
<span class="output-line" id="out114">[&gt; Line 262: (fa 1) [goal&gt; Focused goal (1/1):<br>Systems: default/left (equivalences: left:default/left, right:default/left)<br>Variables: A,B,i:index[const, glob],t,t0:timestamp[const, glob]<br>Hcorrupt: [<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; t)]<br>Heq: [t = <span class='ga'>A2(A, B, i)</span>]<br>Hhap: [t &lt;= t0]<br><span class='sep'>----------------------------------------</span><br>0: <span class='gm'>frame</span>@t0<br>1: <span class='gm'>cond</span>@t<br>2: diff(<span class='gn'>n_PRF</span>, <span class='gn'>nfresh</span>)<br><br><br></span>
</span>

<span class="squirrel-step" id="step115">
<span class="input-line" id="in115"><br>  by fresh 2.</span>
<span class="output-line" id="out115">[&gt; Line 263: by (fresh ...) Freshness on the left side:<br> <br>Freshness on the right side:<br> <br>[goal&gt; Goal kA_strong_forward_secrecy is proved </span>
</span>

<span class="squirrel-step" id="step116">
<span class="input-line" id="in116"><br>Qed.</span>
<span class="output-line" id="out116"><span class='goal' style='color: #AA0000'>goal</span> [default/left (equivalences: left:default/left, right:default/left)] kA_strong_forward_secrecy :<br>  Forall (t,t0:timestamp[const, glob],A,B,i:index[const, glob]),<br>    [t = <span class='ga'>A2(A, B, i)</span>] -&gt;<br>    [t &lt;= t0] -&gt;<br>    [<span class='gf'>not</span> (<span class='ga'>corrupt(B)</span> &lt; t)] -&gt;<br>    equiv(<span class='gm'>frame</span>@t0, if <span class='gm'>cond</span>@t then diff(<span class='gm'>kA</span>(A, B, i)@t, <span class='gn'>nfresh</span>))<br>Exiting proof mode.<br><br></span>
</span>

</span>
<div class="page-header">
  <img src="logo-circular.png" class="logo">
  <h1 class="project-tagline">Squirrel Prover</h1>
  <a href="https://squirrel-prover.github.io/examples.html" class="header-button">
    <button type="button" class="header-button">Exit</button>
  </a>
  <button type="button" class="header-button" onclick="help()" id="button-panel">Help</button>
</div>

<div class="help-panel" id="help-panel">
  Press the left and right arrows to do and undo an instruction.
  <br><br>
  Alternatively, you can double-click on an instruction.
  <br><br>
  <span style="color: #8B0000;" onmouseenter="highlightOn('in-zone')" onmouseleave="highlightOff('in-zone')">This zone</span> shows a Squirrel file. You can double-click on a comment to collapse it for better readabilility.
  <br><br>
  <span style="color: #8B0000;" onmouseenter="highlightOn('out-zone')" onmouseleave="highlightOff('out-zone')">This zone</span> shows the output given by Squirrel.
  <br><br>
  <span style="color: #8B0000;" onmouseenter="highlightOn('prec-zone')" onmouseleave="highlightOff('prec-zone')">This zone</span> shows the output of the previous instruction, to help identifying the change caused by the instruction.
</div>

<div class="mainsection" id="main">
  <div class="example-grid">
    <div class="example-col example-col-left" id="in-zone">
      <p class="example-code"><span id="in-line"></span></p>
    </div>
    <div class="example-col example-col-right">
      <div class="example-code example-code-right" style="height: 45%;	border-bottom: 4px double #8B0000;" id="prec-zone"><span>Previously:</span><br><br><span id="prec-line"></span>
      </div>
      <div style="position: relative;">
      <button type="button" class="prec-button" onclick="hidePrec()" id="prec-button" >Hide</button>
      </div>
      <div class="example-code example-code-right" style="height: 55%;" id="out-zone"><span id="out-line"></span>
      </div>
    </div>
  </div>
</div>

<script src="script.js"></script>

</body>

